<!DOCTYPE html><html class=no-js lang=en> <head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Open documentation for open Network OS" name=description><meta content="SR Linux" name=author><link href=https://learn.srlinux.dev/blog/2023/sr-linux-logging-with-elk/ rel=canonical><link href=../sr-linux-syntax-highlighting-with-pygments/ rel=prev><link href=../../../feed_rss_created.xml rel=alternate title="RSS feed" type=application/rss+xml><link href=../../../feed_rss_updated.xml rel=alternate title="RSS feed of updated content" type=application/rss+xml><link href=../../../images/srlinux.svg rel=icon><meta content="mkdocs-1.4.2, mkdocs-material-9.0.4+insiders-4.27.1" name=generator><title>SR Linux logging with ELK - Learn SR Linux</title><link href=../../../assets/stylesheets/main.a608ba1f.min.css rel=stylesheet><link href=../../../assets/stylesheets/palette.2505c338.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=NokiaPureText:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"NokiaPureText";--md-code-font:"Fira Code"}</style><link href=../../../stylesheets/nokia.css rel=stylesheet><link href=../../../stylesheets/nokia-fonts.css rel=stylesheet><link href=../../../stylesheets/diagrams.css rel=stylesheet><link href=../../../stylesheets/animations.css rel=stylesheet><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-VNYX781Q48"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-VNYX781Q48",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-VNYX781Q48",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><!-- Determine title --><!-- The image needs to have an absolute URL --><!-- Open graph meta tags --><meta content=website property=og:type><meta content="Learn SR Linux - SR Linux logging with ELK" property=og:title><meta content="Open documentation for open Network OS" property=og:description><meta content=https://learn.srlinux.dev/blog/2023/sr-linux-logging-with-elk/ property=og:url><meta content=https://learn.srlinux.dev/images/site-card.png property=og:image><meta content=image/png property=og:image:type><meta content=1200 property=og:image:width><meta content=630 property=og:image:height><!-- Twitter card tags --><meta content=summary_large_image name=twitter:card><meta content="Learn SR Linux - SR Linux logging with ELK" name=twitter:title><meta content="Open documentation for open Network OS" name=twitter:description><meta content=https://learn.srlinux.dev/images/site-card.png name=twitter:image><!-- NOINDEX --><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src=../../../assets/javascripts/glightbox.min.js></script></head> <body data-md-color-accent data-md-color-primary data-md-color-scheme=default dir=ltr> <input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox> <input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a class=md-skip href=#sr-linux-logging-with-elk> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button aria-label="Don't show this again" class="md-banner__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> <a href=https://github.com/nokia/srlinux-container-image> <span class=twemoji> <img alt=🥳 class=twemoji src=https://raw.githubusercontent.com/twitter/twemoji/master/assets/svg/1f973.svg title=:partying_face:> </span> Enjoy the most recent <strong>SR Linux 22.11.1</strong> release! </a> </div> <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script> </aside> </div> <header class=md-header data-md-component=header> <nav aria-label=Header class="md-header__inner md-grid"> <a aria-label="Learn SR Linux" class="md-header__button md-logo" data-md-component=logo href=../../.. title="Learn SR Linux"> <?xml version="1.0" encoding="utf-8"?> <svg height=512 viewbox="0 0 512 512" width=512 xmlns=http://www.w3.org/2000/svg> <rect class=st0 height=512 style="fill: rgb(255, 255, 255);" width=512></rect> <g style transform="matrix(6.08856, 0, 0, 5.722229, -163.634598, -134.644638)"> <path class=st1 d="M45.2,59.4c0.9,0.6,2.2,1.1,4,1.7c1.8,0.6,3.8,0.9,6.2,0.9c2.5,0,4.3-0.5,5.5-1.5c1.2-1,1.8-2.4,1.8-4.1 c0-0.6-0.1-1.2-0.2-1.8c-0.2-0.6-0.5-1.1-0.9-1.6c-0.4-0.5-1-1-1.8-1.4c-0.8-0.4-1.7-0.8-2.9-1.1l-4.1-1.2 c-2.7-0.7-4.8-1.9-6.5-3.4c-1.6-1.5-2.4-3.6-2.4-6.2c0-1.4,0.2-2.7,0.8-3.9s1.2-2.3,2.2-3.2c1-0.9,2.2-1.7,3.7-2.2 c1.4-0.5,3.1-0.8,5-0.8c2.3,0,4.4,0.3,6.2,0.8c1.9,0.5,3.3,1.2,4.4,1.9l-1.7,3.5c-0.3-0.2-0.8-0.4-1.5-0.7 c-0.6-0.2-1.4-0.5-2.2-0.7c-0.8-0.2-1.7-0.4-2.6-0.5c-0.9-0.2-1.9-0.2-2.8-0.2c-2.2,0-4,0.5-5.2,1.5c-1.2,1-1.8,2.4-1.8,4.1 c0,1.5,0.5,2.7,1.4,3.6c0.9,0.9,2.4,1.6,4.6,2.2l4.1,1.2c2.9,0.8,5.2,2,6.7,3.5c1.5,1.5,2.2,3.7,2.2,6.4c0,1.5-0.3,2.9-0.8,4.1 s-1.3,2.3-2.3,3.2c-1,0.9-2.3,1.6-3.8,2.1c-1.5,0.5-3.2,0.7-5.1,0.7c-1.7,0-3.2-0.1-4.6-0.4c-1.4-0.3-2.6-0.6-3.6-0.9 c-1-0.3-1.9-0.7-2.5-1.1c-0.7-0.4-1.1-0.6-1.4-0.8L45.2,59.4z" style="fill: rgb(0, 0, 0);"></path> <path class=st1 d="M 97.5 65.4 L 92.1 65.4 L 83.7 51.2 L 78.5 51.2 L 78.5 65.4 L 74 65.4 L 74 30.3 L 84.2 30.3 C 86.4 30.3 88.2 30.6 89.6 31.3 C 91.1 32 92.2 32.8 93.1 33.9 C 94 35 94.6 36.1 95 37.3 C 95.4 38.5 95.5 39.7 95.5 40.8 C 95.5 43.3 94.9 45.4 93.6 47 C 92.3 48.6 90.5 49.8 88.2 50.6 L 97.5 65.4 Z M 83.81 47.191 C 86.21 47.191 88 46.7 89.2 45.6 C 90.4 44.4 91 42.9 91 40.8 C 91 38.8 90.4 37.2 89.2 36 C 88 34.8 86.3 34.2 84.1 34.2 L 78.6 34.2 L 78.6 47.2 L 83.8 47.2 L 83.81 47.191 Z" style="fill: rgb(0, 0, 0);"></path> </g> <g style transform="matrix(5.538847, 0, 0, 5.68973, -136.858704, -157.860214)"> <path class=st1 d=M46.2,109.9h-14V85.3h3.2V107h10.7V109.9z style="fill: rgb(0, 0, 0);"></path> <path class=st1 d="M51.5,88.8c-0.6,0-1.1-0.2-1.5-0.6c-0.4-0.4-0.5-0.9-0.5-1.5c0-0.6,0.2-1.1,0.5-1.5c0.4-0.4,0.9-0.6,1.5-0.6 s1.1,0.2,1.5,0.6c0.4,0.4,0.5,0.9,0.5,1.5s-0.2,1.1-0.5,1.5C52.6,88.6,52.1,88.8,51.5,88.8z M53.1,109.9H50V92.4h3.1V109.9z" style="fill: rgb(0, 0, 0);"></path> <path class=st1 d="M73,109.9h-3.1V99.1c0-0.9-0.1-1.6-0.3-2.2c-0.2-0.6-0.4-1-0.8-1.4c-0.3-0.3-0.7-0.6-1.2-0.7s-0.9-0.2-1.4-0.2 c-0.9,0-1.7,0.2-2.3,0.5c-0.6,0.4-1.2,0.9-1.6,1.5c-0.4,0.6-0.7,1.3-0.9,2.1c-0.2,0.8-0.3,1.6-0.3,2.5v8.6h-3.1V92.4H61l0.1,2.4 c0.1-0.3,0.4-0.6,0.7-0.9c0.3-0.3,0.7-0.7,1.2-0.9c0.5-0.3,1-0.5,1.7-0.7s1.4-0.3,2.2-0.3c2,0,3.6,0.6,4.6,1.7s1.6,2.8,1.6,4.8 V109.9z" style="fill: rgb(0, 0, 0);"></path> <path class=st1 d="M92.7,109.9h-2.9l-0.1-2.3c-0.1,0.3-0.4,0.6-0.7,0.9c-0.3,0.3-0.7,0.6-1.2,0.9c-0.5,0.3-1,0.5-1.7,0.7 c-0.6,0.2-1.4,0.3-2.2,0.3c-2,0-3.6-0.6-4.6-1.7c-1.1-1.2-1.6-2.8-1.6-4.8V92.4H81v11c0,0.8,0.1,1.5,0.3,2.1c0.2,0.5,0.4,1,0.7,1.3 c0.3,0.3,0.7,0.6,1.1,0.7c0.4,0.1,0.9,0.2,1.5,0.2c0.9,0,1.7-0.2,2.3-0.5c0.6-0.4,1.2-0.9,1.6-1.5s0.7-1.3,0.9-2.1 c0.2-0.8,0.3-1.6,0.3-2.5v-8.6h3.1V109.9z" style="fill: rgb(0, 0, 0);"></path> <path class=st1 d=M112,109.9h-3.7l-4.6-6.7l-4.6,6.7h-3.3l6.3-9l-5.9-8.5h3.7l4,5.8l4-5.8h3.3l-5.7,8.2L112,109.9z style="fill: rgb(0, 0, 0);"></path> </g> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Learn SR Linux </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> SR Linux logging with ELK </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input aria-label="Switch to dark mode" class=md-option data-md-color-accent data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary data-md-color-scheme=default id=__palette_0 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_1 hidden title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg> </label> <input aria-label="Switch to light mode" class=md-option data-md-color-accent data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary data-md-color-scheme=slate id=__palette_1 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_0 hidden title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false type=text> <label class="md-search__icon md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label=Search class=md-search__options> <button aria-label=Clear class="md-search__icon md-icon" tabindex=-1 title=Clear type=reset> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a class=md-source data-md-component=source href=https://github.com/srl-labs/learn-srlinux title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 496 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </div> <div class=md-source__repository> srl-labs/learn-srlinux </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav aria-label=Tabs class=md-tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a class=md-tabs__link href=../../..> Home </a> </li> <li class=md-tabs__item> <a href=../../../get-started/ class=md-tabs__link> Get Started </a> </li> <li class=md-tabs__item> <a href=../../../mgmt/ class=md-tabs__link> Management </a> </li> <li class=md-tabs__item> <a href=../../../programmability/ class=md-tabs__link> Programmability </a> </li> <li class=md-tabs__item> <a href=../../../tutorials/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../../community/ class=md-tabs__link> Community </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Blog </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=Navigation class="md-nav md-nav--primary md-nav--lifted" data-md-level=0> <label class=md-nav__title for=__drawer> <a aria-label="Learn SR Linux" class="md-nav__button md-logo" data-md-component=logo href=../../.. title="Learn SR Linux"> <?xml version="1.0" encoding="utf-8"?> <svg height=512 viewbox="0 0 512 512" width=512 xmlns=http://www.w3.org/2000/svg> <rect class=st0 height=512 style="fill: rgb(255, 255, 255);" width=512></rect> <g style transform="matrix(6.08856, 0, 0, 5.722229, -163.634598, -134.644638)"> <path class=st1 d="M45.2,59.4c0.9,0.6,2.2,1.1,4,1.7c1.8,0.6,3.8,0.9,6.2,0.9c2.5,0,4.3-0.5,5.5-1.5c1.2-1,1.8-2.4,1.8-4.1 c0-0.6-0.1-1.2-0.2-1.8c-0.2-0.6-0.5-1.1-0.9-1.6c-0.4-0.5-1-1-1.8-1.4c-0.8-0.4-1.7-0.8-2.9-1.1l-4.1-1.2 c-2.7-0.7-4.8-1.9-6.5-3.4c-1.6-1.5-2.4-3.6-2.4-6.2c0-1.4,0.2-2.7,0.8-3.9s1.2-2.3,2.2-3.2c1-0.9,2.2-1.7,3.7-2.2 c1.4-0.5,3.1-0.8,5-0.8c2.3,0,4.4,0.3,6.2,0.8c1.9,0.5,3.3,1.2,4.4,1.9l-1.7,3.5c-0.3-0.2-0.8-0.4-1.5-0.7 c-0.6-0.2-1.4-0.5-2.2-0.7c-0.8-0.2-1.7-0.4-2.6-0.5c-0.9-0.2-1.9-0.2-2.8-0.2c-2.2,0-4,0.5-5.2,1.5c-1.2,1-1.8,2.4-1.8,4.1 c0,1.5,0.5,2.7,1.4,3.6c0.9,0.9,2.4,1.6,4.6,2.2l4.1,1.2c2.9,0.8,5.2,2,6.7,3.5c1.5,1.5,2.2,3.7,2.2,6.4c0,1.5-0.3,2.9-0.8,4.1 s-1.3,2.3-2.3,3.2c-1,0.9-2.3,1.6-3.8,2.1c-1.5,0.5-3.2,0.7-5.1,0.7c-1.7,0-3.2-0.1-4.6-0.4c-1.4-0.3-2.6-0.6-3.6-0.9 c-1-0.3-1.9-0.7-2.5-1.1c-0.7-0.4-1.1-0.6-1.4-0.8L45.2,59.4z" style="fill: rgb(0, 0, 0);"></path> <path class=st1 d="M 97.5 65.4 L 92.1 65.4 L 83.7 51.2 L 78.5 51.2 L 78.5 65.4 L 74 65.4 L 74 30.3 L 84.2 30.3 C 86.4 30.3 88.2 30.6 89.6 31.3 C 91.1 32 92.2 32.8 93.1 33.9 C 94 35 94.6 36.1 95 37.3 C 95.4 38.5 95.5 39.7 95.5 40.8 C 95.5 43.3 94.9 45.4 93.6 47 C 92.3 48.6 90.5 49.8 88.2 50.6 L 97.5 65.4 Z M 83.81 47.191 C 86.21 47.191 88 46.7 89.2 45.6 C 90.4 44.4 91 42.9 91 40.8 C 91 38.8 90.4 37.2 89.2 36 C 88 34.8 86.3 34.2 84.1 34.2 L 78.6 34.2 L 78.6 47.2 L 83.8 47.2 L 83.81 47.191 Z" style="fill: rgb(0, 0, 0);"></path> </g> <g style transform="matrix(5.538847, 0, 0, 5.68973, -136.858704, -157.860214)"> <path class=st1 d=M46.2,109.9h-14V85.3h3.2V107h10.7V109.9z style="fill: rgb(0, 0, 0);"></path> <path class=st1 d="M51.5,88.8c-0.6,0-1.1-0.2-1.5-0.6c-0.4-0.4-0.5-0.9-0.5-1.5c0-0.6,0.2-1.1,0.5-1.5c0.4-0.4,0.9-0.6,1.5-0.6 s1.1,0.2,1.5,0.6c0.4,0.4,0.5,0.9,0.5,1.5s-0.2,1.1-0.5,1.5C52.6,88.6,52.1,88.8,51.5,88.8z M53.1,109.9H50V92.4h3.1V109.9z" style="fill: rgb(0, 0, 0);"></path> <path class=st1 d="M73,109.9h-3.1V99.1c0-0.9-0.1-1.6-0.3-2.2c-0.2-0.6-0.4-1-0.8-1.4c-0.3-0.3-0.7-0.6-1.2-0.7s-0.9-0.2-1.4-0.2 c-0.9,0-1.7,0.2-2.3,0.5c-0.6,0.4-1.2,0.9-1.6,1.5c-0.4,0.6-0.7,1.3-0.9,2.1c-0.2,0.8-0.3,1.6-0.3,2.5v8.6h-3.1V92.4H61l0.1,2.4 c0.1-0.3,0.4-0.6,0.7-0.9c0.3-0.3,0.7-0.7,1.2-0.9c0.5-0.3,1-0.5,1.7-0.7s1.4-0.3,2.2-0.3c2,0,3.6,0.6,4.6,1.7s1.6,2.8,1.6,4.8 V109.9z" style="fill: rgb(0, 0, 0);"></path> <path class=st1 d="M92.7,109.9h-2.9l-0.1-2.3c-0.1,0.3-0.4,0.6-0.7,0.9c-0.3,0.3-0.7,0.6-1.2,0.9c-0.5,0.3-1,0.5-1.7,0.7 c-0.6,0.2-1.4,0.3-2.2,0.3c-2,0-3.6-0.6-4.6-1.7c-1.1-1.2-1.6-2.8-1.6-4.8V92.4H81v11c0,0.8,0.1,1.5,0.3,2.1c0.2,0.5,0.4,1,0.7,1.3 c0.3,0.3,0.7,0.6,1.1,0.7c0.4,0.1,0.9,0.2,1.5,0.2c0.9,0,1.7-0.2,2.3-0.5c0.6-0.4,1.2-0.9,1.6-1.5s0.7-1.3,0.9-2.1 c0.2-0.8,0.3-1.6,0.3-2.5v-8.6h3.1V109.9z" style="fill: rgb(0, 0, 0);"></path> <path class=st1 d=M112,109.9h-3.7l-4.6-6.7l-4.6,6.7h-3.3l6.3-9l-5.9-8.5h3.7l4,5.8l4-5.8h3.3l-5.7,8.2L112,109.9z style="fill: rgb(0, 0, 0);"></path> </g> </svg> </a> Learn SR Linux </label> <div class=md-nav__source> <a class=md-source data-md-component=source href=https://github.com/srl-labs/learn-srlinux title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 496 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </div> <div class=md-source__repository> srl-labs/learn-srlinux </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../..> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../get-started/ class=md-nav__link> <span class=md-ellipsis> Get Started </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 id=__nav_3 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../mgmt/ class=md-nav__link> <span class=md-ellipsis> Management </span> </a> </div> <nav aria-label=Management class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Management </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 id=__nav_4 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../programmability/ class=md-nav__link> <span class=md-ellipsis> Programmability </span> </a> <label class=md-nav__link for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label=Programmability class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Programmability </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 id=__nav_4_2 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../yang/ class=md-nav__link> <span class=md-ellipsis> YANG </span> </a> <label class=md-nav__link for=__nav_4_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label=YANG class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> YANG </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../yang/browser/ class=md-nav__link> <span class=md-ellipsis> YANG Browser </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 id=__nav_4_3 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../ndk/ class=md-nav__link> <span class=md-ellipsis> NDK </span> </a> <label class=md-nav__link for=__nav_4_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label=NDK class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> NDK </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_2 id=__nav_4_3_2 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_4_3_2 tabindex=0> <span class=md-ellipsis> Developers Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Developers Guide" class=md-nav data-md-level=3> <label class=md-nav__title for=__nav_4_3_2> <span class="md-nav__icon md-icon"></span> Developers Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ndk/guide/architecture/ class=md-nav__link> <span class=md-ellipsis> NDK Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../ndk/guide/agent/ class=md-nav__link> <span class=md-ellipsis> Agent Structure </span> </a> </li> <li class=md-nav__item> <a href=../../../ndk/guide/agent-install-and-ops/ class=md-nav__link> <span class=md-ellipsis> Agent Installation &amp; Operations </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_2_4 id=__nav_4_3_2_4 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_4_3_2_4 tabindex=0> <span class=md-ellipsis> Environment Setup </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Environment Setup" class=md-nav data-md-level=4> <label class=md-nav__title for=__nav_4_3_2_4> <span class="md-nav__icon md-icon"></span> Environment Setup </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ndk/guide/env/go/ class=md-nav__link> <span class=md-ellipsis> Go </span> </a> </li> <li class=md-nav__item> <a href=../../../ndk/guide/env/python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_2_5 id=__nav_4_3_2_5 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_4_3_2_5 tabindex=0> <span class=md-ellipsis> Developing with NDK </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Developing with NDK" class=md-nav data-md-level=4> <label class=md-nav__title for=__nav_4_3_2_5> <span class="md-nav__icon md-icon"></span> Developing with NDK </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ndk/guide/dev/go/ class=md-nav__link> <span class=md-ellipsis> Go </span> </a> </li> <li class=md-nav__item> <a href=../../../ndk/guide/dev/python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3_3 id=__nav_4_3_3 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../ndk/apps/ class=md-nav__link> <span class=md-ellipsis> App Catalog </span> </a> <label class=md-nav__link for=__nav_4_3_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label="App Catalog" class=md-nav data-md-level=3> <label class=md-nav__title for=__nav_4_3_3> <span class="md-nav__icon md-icon"></span> App Catalog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ndk/apps/evpn-proxy/ class=md-nav__link> <span class=md-ellipsis> EVPN Proxy </span> </a> </li> <li class=md-nav__item> <a href=../../../ndk/apps/kbutler/ class=md-nav__link> <span class=md-ellipsis> kButler </span> </a> </li> <li class=md-nav__item> <a href=../../../ndk/apps/srl-prom-exporter/ class=md-nav__link> <span class=md-ellipsis> Prometheus Telemetry Exporter </span> </a> </li> <li class=md-nav__item> <a href=../../../ndk/apps/satellite/ class=md-nav__link> <span class=md-ellipsis> Satellite Tracker </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 id=__nav_5 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../tutorials/ class=md-nav__link> <span class=md-ellipsis> Tutorials </span> </a> <label class=md-nav__link for=__nav_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label=Tutorials class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_2 id=__nav_5_2 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_5_2 tabindex=0> <span class=md-ellipsis> EVPN </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label=EVPN class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> EVPN </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_2_1 id=__nav_5_2_1 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_5_2_1 tabindex=0> <span class=md-ellipsis> Layer 2 EVPN </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Layer 2 EVPN" class=md-nav data-md-level=3> <label class=md-nav__title for=__nav_5_2_1> <span class="md-nav__icon md-icon"></span> Layer 2 EVPN </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tutorials/l2evpn/intro/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/l2evpn/fabric/ class=md-nav__link> <span class=md-ellipsis> Fabric configuration </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/l2evpn/evpn/ class=md-nav__link> <span class=md-ellipsis> EVPN configuration </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/l2evpn/summary/ class=md-nav__link> <span class=md-ellipsis> Summary </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_3 id=__nav_5_3 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_5_3 tabindex=0> <span class=md-ellipsis> Infrastructure </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label=Infrastructure class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_3_1 id=__nav_5_3_1 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../tutorials/infrastructure/kne/ class=md-nav__link> <span class=md-ellipsis> KNE </span> </a> <label class=md-nav__link for=__nav_5_3_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label=KNE class=md-nav data-md-level=3> <label class=md-nav__title for=__nav_5_3_1> <span class="md-nav__icon md-icon"></span> KNE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tutorials/infrastructure/kne/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/infrastructure/kne/topology/ class=md-nav__link> <span class=md-ellipsis> Topology </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_3_1_4 id=__nav_5_3_1_4 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../../tutorials/infrastructure/kne/srl-with-oc-services/ class=md-nav__link> <span class=md-ellipsis> SR Linux with Openconfig services </span> </a> </div> <nav aria-label="SR Linux with Openconfig services" class=md-nav data-md-level=4> <label class=md-nav__title for=__nav_5_3_1_4> <span class="md-nav__icon md-icon"></span> SR Linux with Openconfig services </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_4 id=__nav_5_4 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_5_4 tabindex=0> <span class=md-ellipsis> MPLS </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label=MPLS class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> MPLS </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_4_1 id=__nav_5_4_1 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_5_4_1 tabindex=0> <span class=md-ellipsis> LDP-based MPLS </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="LDP-based MPLS" class=md-nav data-md-level=3> <label class=md-nav__title for=__nav_5_4_1> <span class="md-nav__icon md-icon"></span> LDP-based MPLS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tutorials/mpls/mpls-ldp/intro/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/mpls/mpls-ldp/routing/ class=md-nav__link> <span class=md-ellipsis> Routing </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/mpls/mpls-ldp/ldp/ class=md-nav__link> <span class=md-ellipsis> LDP </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_5 id=__nav_5_5 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_5_5 tabindex=0> <span class=md-ellipsis> Programmability </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label=Programmability class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> Programmability </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_5_1 id=__nav_5_5_1 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_5_5_1 tabindex=0> <span class=md-ellipsis> Event Handler </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Event Handler" class=md-nav data-md-level=3> <label class=md-nav__title for=__nav_5_5_1> <span class="md-nav__icon md-icon"></span> Event Handler </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_5_1_1 id=__nav_5_5_1_1 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_5_5_1_1 tabindex=0> <span class=md-ellipsis> Oper Group </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Oper Group" class=md-nav data-md-level=4> <label class=md-nav__title for=__nav_5_5_1_1> <span class="md-nav__icon md-icon"></span> Oper Group </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tutorials/programmability/event-handler/oper-group/oper-group-intro/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/programmability/event-handler/oper-group/lab/ class=md-nav__link> <span class=md-ellipsis> Lab setup </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/programmability/event-handler/oper-group/problem-statement/ class=md-nav__link> <span class=md-ellipsis> Problem statement </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/programmability/event-handler/oper-group/oper-group-cfg/ class=md-nav__link> <span class=md-ellipsis> Configuring oper-group </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/programmability/event-handler/oper-group/script/ class=md-nav__link> <span class=md-ellipsis> Script </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/programmability/event-handler/oper-group/opergroup-operation/ class=md-nav__link> <span class=md-ellipsis> Oper group in action </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/programmability/event-handler/oper-group/summary/ class=md-nav__link> <span class=md-ellipsis> Summary </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_5_2 id=__nav_5_5_2 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_5_5_2 tabindex=0> <span class=md-ellipsis> JSON-RPC </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-label=JSON-RPC class=md-nav data-md-level=3> <label class=md-nav__title for=__nav_5_5_2> <span class="md-nav__icon md-icon"></span> JSON-RPC </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tutorials/programmability/json-rpc/basics/ class=md-nav__link> <span class=md-ellipsis> Basics </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/programmability/json-rpc/ansible/ class=md-nav__link> <span class=md-ellipsis> Ansible </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../community/ class=md-nav__link> <span class=md-ellipsis> Community </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 id=__nav_7 type=checkbox> <div class="md-nav__link md-nav__container"> <a href=../../ class=md-nav__link> <span class=md-ellipsis> Blog </span> </a> <label class=md-nav__link for=__nav_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-label=Blog class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../subscribe/ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20 5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"></path></svg> <span class=md-ellipsis> Subscribe </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#lab> <span class=md-ellipsis> Lab </span> </a> <nav aria-label=Lab class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#topology> <span class=md-ellipsis> Topology </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#deployment> <span class=md-ellipsis> Deployment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#logging-with-syslog-and-elk> <span class=md-ellipsis> Logging with Syslog and ELK </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#configuring-logging-on-sr-linux> <span class=md-ellipsis> Configuring logging on SR Linux </span> </a> <nav aria-label="Configuring logging on SR Linux" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#log-format> <span class=md-ellipsis> Log format </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#logstash> <span class=md-ellipsis> Logstash </span> </a> <nav aria-label=Logstash class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#input> <span class=md-ellipsis> Input </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#filter> <span class=md-ellipsis> Filter </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#output> <span class=md-ellipsis> Output </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#debugging> <span class=md-ellipsis> Debugging </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#elasticsearch> <span class=md-ellipsis> Elasticsearch </span> </a> <nav aria-label=Elasticsearch class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#index-template-and-mappings> <span class=md-ellipsis> Index Template and Mappings </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#querying-the-index> <span class=md-ellipsis> Querying the index </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#kibana> <span class=md-ellipsis> Kibana </span> </a> <nav aria-label=Kibana class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#index-management> <span class=md-ellipsis> Index Management </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#index-patterns> <span class=md-ellipsis> Index Patterns </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#discover> <span class=md-ellipsis> Discover </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#dashboard> <span class=md-ellipsis> Dashboard </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#summary> <span class=md-ellipsis> Summary </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class=md-nav> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=../../ class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> <span class=md-ellipsis> Back to index </span> </a> </div> </div> <div class="md-post__authors md-typeset"> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img alt="Anton Zyablov" src=https://avatars.githubusercontent.com/u/22647209> </span> <span class=md-profile__description> <strong>Anton Zyablov</strong><br> Lead Solution Architect </span> </div> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img alt="Roman Dodin" src=https://avatars.githubusercontent.com/u/5679861> </span> <span class=md-profile__description> <strong>Roman Dodin</strong><br> SR Linux PLM </span> </div> </div> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__title"> <div class=md-nav__link> <span class=md-ellipsis> Metadata </span> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"></path></svg> <time class=md-ellipsis datetime="2023-02-12 00:00:00">February 12, 2023</time> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"></path></svg> <span class=md-ellipsis> 16 min read </span> </div> </li> </ul> </nav> </div> </div> </div> <article class="md-content__inner md-typeset"> <nav class=md-tags> <a class=md-tag href=../../tags/#syslog>syslog</a> <a class=md-tag href=../../tags/#sr-linux>sr linux</a> <a class=md-tag href=../../tags/#elk>elk</a> <a class=md-tag href=../../tags/#logging>logging</a> </nav> <a class="md-content__button md-icon" href=https://github.com/srl-labs/learn-srlinux/edit/main/docs/blog/posts/2023/srl-elk.md title="Edit this page"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"></path></svg> </a> <h1 id=sr-linux-logging-with-elk>SR Linux logging with ELK<a class=headerlink href=#sr-linux-logging-with-elk title="Permanent link">#</a></h1> <p>In a not-so-distant past, manually extracting, parsing, and reading log files produced by network elements was standard practice for a sysadmin. With arcane piping of old-but-good <code>grep</code>, <code>awk</code>, and <code>sed</code> tools, one could swiftly identify a problem in a relatively large system. This was a viable approach for quite some time, but it became prey to a massive scale.</p> <p>Today's network infrastructures often count thousands of elements, each emitting log messages. Getting through a log collection of this size with CLI tools designed decades ago might not be the best tactic. As well as correlating logs between network elements and application logs might be impossible without software solutions built with such use cases in mind.</p> <p>The unprecedented growth in the application world boosted the development of multi-purposed centralized/cloud data collectors that make observability and discovery over huge data sets a reality. Elasticsearch / Logstash / Kibana (or ELK for short) is one of the most known open-source stacks tailored for the collection and processing of various documents, logs included.</p> <p>To enable the processing of captured logs and deliver performant and robust search analytics log collectors rely on structured data. Unfortunately, the networking world is infamous for iterating slowly. For example, an outdated and informational <a href=https://en.wikipedia.org/wiki/Syslog>Syslog</a> interface still dominates the networking space when it comes to managing and transferring logs. <a href=https://datatracker.ietf.org/doc/html/rfc3164>Syslog RFC3164</a><sup id=fnref:4><a class=footnote-ref href=#fn:4>4</a></sup> was not designed to allow extensible structured payloads, which adds a fair share of problems with integrating such systems with modern log collectors.</p> <p>This post explains how an SR Linux-powered DC fabric can be integrated with a modern logging infrastructure based on the Elasticsearch / Logstash / Kibana stack to collect, transform, handle, and view logs.</p> <!-- more --> <h2 id=lab>Lab<a class=headerlink href=#lab title="Permanent link">#</a></h2> <p>As you would have expected, the post is accompanied by the <a href=https://containerlab.dev/install/#install-script>containerlab</a>-based <a href=https://github.com/srl-labs/srl-elk-lab/blob/main/srl-elk.clab.yml>lab</a> that consists of an SR Linux fabric and ELK stack.<br> DC Fabric comes preconfigured with an EVPN-VXLAN L2 domain instance, and syslog-based logging is set up on the SR Linux network elements.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Anyone can spin this lab on their machine since all the lab elements are using official public container images.</p> </div> <table> <thead> <tr> <th align=left>Summary</th> <th align=left></th> </tr> </thead> <tbody> <tr> <td align=left><strong>Lab name</strong></td> <td align=left>SR Linux fabric with ELK stack</td> </tr> <tr> <td align=left><strong>Lab components</strong></td> <td align=left>Nokia SR Linux, ELK stack</td> </tr> <tr> <td align=left><strong>Resource requirements</strong></td> <td align=left><span class=twemoji><svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M176 24c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c-35.3 0-64 28.7-64 64H24c-13.3 0-24 10.7-24 24s10.7 24 24 24h40v56H24c-13.3 0-24 10.7-24 24s10.7 24 24 24h40v56H24c-13.3 0-24 10.7-24 24s10.7 24 24 24h40c0 35.3 28.7 64 64 64v40c0 13.3 10.7 24 24 24s24-10.7 24-24v-40h56v40c0 13.3 10.7 24 24 24s24-10.7 24-24v-40h56v40c0 13.3 10.7 24 24 24s24-10.7 24-24v-40c35.3 0 64-28.7 64-64h40c13.3 0 24-10.7 24-24s-10.7-24-24-24h-40v-56h40c13.3 0 24-10.7 24-24s-10.7-24-24-24h-40v-56h40c13.3 0 24-10.7 24-24s-10.7-24-24-24h-40c0-35.3-28.7-64-64-64V24c0-13.3-10.7-24-24-24s-24 10.7-24 24v40h-56V24c0-13.3-10.7-24-24-24s-24 10.7-24 24v40h-56V24zm-16 104h192c17.7 0 32 14.3 32 32v192c0 17.7-14.3 32-32 32H160c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32zm192 32H160v192h192V160z"></path></svg></span> 6 vCPU <br><span class=twemoji><svg viewbox="0 0 576 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M64 64C28.7 64 0 92.7 0 128v7.4c0 6.8 4.4 12.6 10.1 16.3C23.3 160.3 32 175.1 32 192s-8.7 31.7-21.9 40.3C4.4 236 0 241.8 0 248.6V320h576v-71.4c0-6.8-4.4-12.6-10.1-16.3-13.2-8.6-21.9-23.4-21.9-40.3s8.7-31.7 21.9-40.3c5.7-3.7 10.1-9.5 10.1-16.3V128c0-35.3-28.7-64-64-64H64zm512 288H0v64c0 17.7 14.3 32 32 32h48v-32c0-8.8 7.2-16 16-16s16 7.2 16 16v32h96v-32c0-8.8 7.2-16 16-16s16 7.2 16 16v32h96v-32c0-8.8 7.2-16 16-16s16 7.2 16 16v32h96v-32c0-8.8 7.2-16 16-16s16 7.2 16 16v32h48c17.7 0 32-14.3 32-32v-64zM192 160v64c0 17.7-14.3 32-32 32s-32-14.3-32-32v-64c0-17.7 14.3-32 32-32s32 14.3 32 32zm128 0v64c0 17.7-14.3 32-32 32s-32-14.3-32-32v-64c0-17.7 14.3-32 32-32s32 14.3 32 32zm128 0v64c0 17.7-14.3 32-32 32s-32-14.3-32-32v-64c0-17.7 14.3-32 32-32s32 14.3 32 32z"></path></svg></span> 12 GB</td> </tr> <tr> <td align=left><strong>Lab</strong></td> <td align=left><a href=https://github.com/srl-labs/srl-elk-lab>srl-labs/srl-elk-lab</a></td> </tr> <tr> <td align=left><strong>Version information</strong><sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup></td> <td align=left><a href=https://containerlab.dev/install/#install-script><code>containerlab:0.36.1</code></a>, <a href=https://github.com/nokia/srlinux-container-image><code>srlinux:22.11.1</code></a>, ELK stack 7.17.7</td> </tr> <tr> <td align=left><strong>Authors</strong></td> <td align=left>Anton Zyablov <a href=https://linkedin.com/in/anton-zyablov><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77Z"></path></svg></span></a> <br> Roman Dodin <a href=https://twitter.com/ntdvps><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23Z"></path></svg></span></a> <a href=https://linkedin.com/in/rdodin><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77Z"></path></svg></span></a></td> </tr> </tbody> </table> <p><a href=https://github.com/srl-labs/srl-elk-lab>Lab repository</a> contains all necessary configuration artifacts, which are mounted to the respective container nodes as outlined in the <a href=https://github.com/srl-labs/srl-elk-lab/blob/main/srl-elk.clab.yml>topology file</a>.</p> <h3 id=topology>Topology<a class=headerlink href=#topology title="Permanent link">#</a></h3> <p>A 2-tier DC fabric consists of two spines and four leaves. ELK stack consists of Elasticsearch, Logstash and Kibana nodes.</p> <div class=mxgraph data-mxgraph='{"page":1,"zoom":2,"highlight":"#0000ff","nav":true,"check-visible-state":true,"resize":true,"url":"https://raw.githubusercontent.com/srl-labs/srl-elk-lab/diagrams/elk.drawio"}' style="max-width:100%;border:1px solid transparent;margin:0 auto; display:block;"></div> <p>Two clients emulated with Linux containers are connected to the leaves.</p> <h3 id=deployment>Deployment<a class=headerlink href=#deployment title="Permanent link">#</a></h3> <p>Prior to deploying the lab, make sure that containerlab is <a href=https://containerlab.dev/install/#install-script>installed</a>. The following installation script installs containerlab on most Linux systems.</p> <div class="language-bash highlight"><span class=filename>Containerlab installation via installation-script</span><pre><span></span><code><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a>bash<span class=w> </span>-c<span class=w> </span><span class=s2>"</span><span class=k>$(</span>curl<span class=w> </span>-sL<span class=w> </span>https://get.containerlab.dev<span class=k>)</span><span class=s2>"</span>
</code></pre></div> <p>In order to bring up your lab, follow the next simple steps:</p> <ol> <li> <p>Clone repo</p> <div class="language-sh highlight"><pre><span></span><code><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/srl-labs/srl-elk-lab.git
<a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a><span class=nb>cd</span><span class=w> </span>srl-elk-lab
</code></pre></div> </li> <li> <p>Deploy the lab</p> <div class="language-sh highlight"><pre><span></span><code><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a>sudo<span class=w> </span>clab<span class=w> </span>deploy<span class=w> </span>-c
</code></pre></div> </li> </ol> <p>After a quick minute, 5 SR Linux nodes and ELK stack should be in a running state.</p> <h2 id=logging-with-syslog-and-elk>Logging with Syslog and ELK<a class=headerlink href=#logging-with-syslog-and-elk title="Permanent link">#</a></h2> <p>Nowadays, instead of keeping unstructured logs on a device and grepping through them, logs are being collected, parsed, and indexed for quick and efficient access. Elasticsearch/Logstash/Kibana (or ELK for short) is the popular stack of technologies that enable modern logging infrastructure. This particular logging stack is used in application and networking realms alike.</p> <p>We will use the ELK stack to collect, parse, transform, and store logs from SR Linux network elements.</p> <p>On a high level, our data pipeline undergoes the following stages:</p> <ol> <li>SR Linux is configured to send syslog messages to Logstash.</li> <li>Logstash receives raw syslog messages, parses it to create a structured document format, and passes it over to Elasticsearch.</li> <li>Elasticsearch receives structured documents that it indexes and stores.</li> </ol> <div class=mxgraph data-mxgraph='{"page":2,"zoom":2,"highlight":"#0000ff","nav":true,"check-visible-state":true,"resize":true,"url":"https://raw.githubusercontent.com/srl-labs/srl-elk-lab/diagrams/elk.drawio"}' style="max-width:100%;border:1px solid transparent;margin:0 auto; display:block;"></div> <p>The subsequent chapters of this blog post will zoom in on each of those steps and guide the readers through the process of creating a logging pipeline, running search queries, and using Kibana visualizations.</p> <h2 id=configuring-logging-on-sr-linux>Configuring logging on SR Linux<a class=headerlink href=#configuring-logging-on-sr-linux title="Permanent link">#</a></h2> <p>Let's start from the beginning of our data pipeline and configure logging on SR Linux nodes.</p> <p>Nokia SR Linux Network OS design employs a high level of granularity where each service is represented as a standalone process with a messaging bus enabling inter-process communication. These processes implement logging via the standard Linux <a href=https://en.wikipedia.org/wiki/Syslog>syslog</a> interface. In particular, SR Linux uses a well-known <a href=https://www.rsyslog.com/ >rsyslog</a> server to manage syslog messages in the underlying Linux OS.</p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Refer to the <a href=https://documentation.nokia.com/srlinux/22-6/SR_Linux_Book_Files/Configuration_Basics_Guide/configb-logging.html>official Logging configuration guide</a> and <a href=https://documentation.nokia.com/srlinux/22-6/SR_Linux_Book_Files/Log_Events/log-intro.html>Log Events Guide</a> to learn more about logging configuration on SR Linux.</p> </div> <p>You can modify the SR Linux logging configuration using the CLI, northbound API, or by editing the rsyslog config files<sup id=fnref:2><a class=footnote-ref href=#fn:2>2</a></sup>.</p> <p>Basic logging configuration consists of specifying a source for input log messages, filtering the log messages, and specifying an output destination for the filtered log messages.</p> <p>Messages logged to Linux syslog facilities and messages generated by SR Linux subsystems can be used as input sources for log messages. You can find a list of those facilities and subsystems in the <a href=https://documentation.nokia.com/srlinux/22-6/SR_Linux_Book_Files/Configuration_Basics_Guide/configb-logging.html#ai9ep6mg6x>documentation</a>.<br> When defining a Linux OS facility or SR Linux subsystem as a log source, users can provide a priority param that narrows the capture to a given severity<sup id=fnref:3><a class=footnote-ref href=#fn:3>3</a></sup>, a range, or a specific set of severities.</p> <p>A <a href=https://documentation.nokia.com/srlinux/22-6/SR_Linux_Book_Files/Configuration_Basics_Guide/configb-logging.html#ai9ep6mg65>destination</a> for the ingested and filtered log messages can be one of the following:</p> <ul> <li><strong>local log file:</strong> a file on disk that can be configured with retention policies.</li> <li><strong>buffer:</strong> an in-memory file.</li> <li><strong>console:</strong> console output.</li> <li><strong>remote:</strong> remote server.</li> </ul> <p>In the course of this blog post, we will work with a <code>remote-destination</code> output type, as we intend to send the log messages over to Logstash for processing.</p> <p>With a basic understanding of how to configure logging on SR Linux, let's see what does logging configuration look like as seen on <code>leaf1</code> node:</p> <div class="language-srl highlight"><span class=filename>Syslog configuration on leaf1</span><pre><span></span><code><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a><span class=c>--{ running }--[  ]--</span>
<a href=#__codelineno-3-2 id=__codelineno-3-2 name=__codelineno-3-2></a>A:leaf1# <span class=n>enter candidate  </span>
<a href=#__codelineno-3-3 id=__codelineno-3-3 name=__codelineno-3-3></a><span class=c>--{ candidate shared default }--[  ]--</span>
<a href=#__codelineno-3-4 id=__codelineno-3-4 name=__codelineno-3-4></a>A:leaf1# <span class=n>system logging  </span>
<a href=#__codelineno-3-5 id=__codelineno-3-5 name=__codelineno-3-5></a><span class=c>--{ candidate shared default }--[ system logging ]--</span>
<a href=#__codelineno-3-6 id=__codelineno-3-6 name=__codelineno-3-6></a>A:leaf1# <span class=n>info </span>
<a href=#__codelineno-3-7 id=__codelineno-3-7 name=__codelineno-3-7></a><span class=err>    network-instance mgmt</span>
<a href=#__codelineno-3-8 id=__codelineno-3-8 name=__codelineno-3-8></a><span class=err>    buffer messages {</span>
<a href=#__codelineno-3-9 id=__codelineno-3-9 name=__codelineno-3-9></a><span class=c>        # snip</span>
<a href=#__codelineno-3-10 id=__codelineno-3-10 name=__codelineno-3-10></a><span class=err>    }</span>
<a href=#__codelineno-3-11 id=__codelineno-3-11 name=__codelineno-3-11></a><span class=err>    buffer system {</span>
<a href=#__codelineno-3-12 id=__codelineno-3-12 name=__codelineno-3-12></a><span class=c>        # snip</span>
<a href=#__codelineno-3-13 id=__codelineno-3-13 name=__codelineno-3-13></a><span class=err>    }</span>
<a href=#__codelineno-3-14 id=__codelineno-3-14 name=__codelineno-3-14></a><span class=err>    file messages {</span>
<a href=#__codelineno-3-15 id=__codelineno-3-15 name=__codelineno-3-15></a><span class=c>        # snip</span>
<a href=#__codelineno-3-16 id=__codelineno-3-16 name=__codelineno-3-16></a><span class=err>    }</span>
<a href=#__codelineno-3-17 id=__codelineno-3-17 name=__codelineno-3-17></a><span class=err>    remote-server </span><span class=no>172.22.22.11 </span><span class=err>{</span>
<a href=#__codelineno-3-18 id=__codelineno-3-18 name=__codelineno-3-18></a><span class=err>        transport udp</span>
<a href=#__codelineno-3-19 id=__codelineno-3-19 name=__codelineno-3-19></a><span class=err>        remote-port</span> <span class=no>1514</span>
<a href=#__codelineno-3-20 id=__codelineno-3-20 name=__codelineno-3-20></a><span class=err>        subsystem aaa {</span>
<a href=#__codelineno-3-21 id=__codelineno-3-21 name=__codelineno-3-21></a><span class=err>            priority {</span>
<a href=#__codelineno-3-22 id=__codelineno-3-22 name=__codelineno-3-22></a><span class=err>                match-above informational</span>
<a href=#__codelineno-3-23 id=__codelineno-3-23 name=__codelineno-3-23></a><span class=err>            }</span>
<a href=#__codelineno-3-24 id=__codelineno-3-24 name=__codelineno-3-24></a><span class=err>        }</span>
<a href=#__codelineno-3-25 id=__codelineno-3-25 name=__codelineno-3-25></a><span class=err>        subsystem acl {</span>
<a href=#__codelineno-3-26 id=__codelineno-3-26 name=__codelineno-3-26></a><span class=err>            priority {</span>
<a href=#__codelineno-3-27 id=__codelineno-3-27 name=__codelineno-3-27></a><span class=err>                match-above informational</span>
<a href=#__codelineno-3-28 id=__codelineno-3-28 name=__codelineno-3-28></a><span class=err>            }</span>
<a href=#__codelineno-3-29 id=__codelineno-3-29 name=__codelineno-3-29></a><span class=err>        }</span>
<a href=#__codelineno-3-30 id=__codelineno-3-30 name=__codelineno-3-30></a><span class=c>        # other subsystems snipped here for brevity</span>
<a href=#__codelineno-3-31 id=__codelineno-3-31 name=__codelineno-3-31></a><span class=err>        subsystem vxlan {</span>
<a href=#__codelineno-3-32 id=__codelineno-3-32 name=__codelineno-3-32></a><span class=err>            priority {</span>
<a href=#__codelineno-3-33 id=__codelineno-3-33 name=__codelineno-3-33></a><span class=err>                match-above informational</span>
<a href=#__codelineno-3-34 id=__codelineno-3-34 name=__codelineno-3-34></a><span class=err>            }</span>
<a href=#__codelineno-3-35 id=__codelineno-3-35 name=__codelineno-3-35></a><span class=err>        }</span>
<a href=#__codelineno-3-36 id=__codelineno-3-36 name=__codelineno-3-36></a><span class=err>    }</span>
</code></pre></div> <p>The <code>remote-server 172.22.22.11</code> container is where we configure a remote syslog collector; the remote server IP matches the Logstash node address specified in the topology file. A transport protocol/port is provided for the remote log destination, followed by several SR Linux subsystems for which we would like logs to be sent.</p> <h3 id=log-format>Log format<a class=headerlink href=#log-format title="Permanent link">#</a></h3> <p>Consider the following example of syslog-formatted messages that can be seen on SR Linux:</p> <div class="language-text highlight"><pre><span></span><code><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a>Jan 11 18:39:02 leaf2 sr_bgp_mgr: bgp|1894|1965|00075|N: In network-instance default, the BGP session with VR default (1): Group ibgp-evpn: Peer 10.0.0.5 moved into the ESTABLISHED state
<a href=#__codelineno-4-2 id=__codelineno-4-2 name=__codelineno-4-2></a>Jan 11 18:39:02 leaf2 sr_bfd_mgr: bfd|1879|1879|00062|N: BFD:  Network-instance default - The protocol BGP is now using BFD session from 10.0.0.2:16395 to 10.0.0.5:0
<a href=#__codelineno-4-3 id=__codelineno-4-3 name=__codelineno-4-3></a>Jan 11 18:39:02 leaf2 sr_bfd_mgr: bfd|1879|1879|00063|N: BFD:  Network-instance default - Session from 10.0.0.2:16395 to 10.0.0.5:16405 is UP
<a href=#__codelineno-4-4 id=__codelineno-4-4 name=__codelineno-4-4></a>Jan 11 18:40:31 leaf2 sr_linux_mgr: linux|1658|1658|00256|W: Memory utilization on ram module 1 is above 70%, current usage 83%
</code></pre></div> <p>Log message format that is used by rsyslog when sending to remote destination has the following signature:</p> <div class="language-go highlight"><pre><span></span><code><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a><span class=p>&lt;</span><span class=nx>TIMESTAMP</span><span class=p>&gt;</span><span class=w> </span><span class=p>&lt;</span><span class=nx>HOSTNAME</span><span class=p>&gt;</span><span class=w> </span><span class=p>&lt;</span><span class=nx>APPLICATION</span><span class=p>&gt;:</span><span class=w> </span><span class=p>&lt;</span><span class=nx>SUBSYSTEM</span><span class=p>&gt;</span><span class=o>|</span><span class=p>&lt;</span><span class=nx>PID</span><span class=p>&gt;</span><span class=o>|</span><span class=p>&lt;</span><span class=nx>THREAD_ID</span><span class=p>&gt;</span><span class=o>|</span><span class=p>&lt;</span><span class=nx>SEQUENCE</span><span class=p>&gt;</span><span class=o>|</span><span class=p>&lt;</span><span class=nx>SEVERITY</span><span class=p>&gt;:</span><span class=w> </span><span class=p>&lt;</span><span class=nx>MESSAGE</span><span class=p>&gt;</span>
</code></pre></div> <p>where</p> <div class="language-go highlight"><pre><span></span><code><a href=#__codelineno-6-1 id=__codelineno-6-1 name=__codelineno-6-1></a><span class=p>&lt;</span><span class=nx>TIMESTAMP</span><span class=p>&gt;</span><span class=w>   </span><span class=o>-</span><span class=w> </span><span class=nx>Time</span><span class=w> </span><span class=nx>in</span><span class=w> </span><span class=nx>format</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nx>MMM</span><span class=w> </span><span class=nx>DD</span><span class=w> </span><span class=nx>HH</span><span class=p>:</span><span class=nx>MM</span><span class=p>:</span><span class=nx>SS</span><span class=p>.</span>
<a href=#__codelineno-6-2 id=__codelineno-6-2 name=__codelineno-6-2></a><span class=p>&lt;</span><span class=nx>HOSTNAME</span><span class=p>&gt;</span><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=nx>SR</span><span class=w> </span><span class=nx>Linux</span><span class=w> </span><span class=nx>hostname</span><span class=p>.</span>
<a href=#__codelineno-6-3 id=__codelineno-6-3 name=__codelineno-6-3></a><span class=p>&lt;</span><span class=nx>APPLICATION</span><span class=p>&gt;</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nx>SR</span><span class=w> </span><span class=nx>Linux</span><span class=w> </span><span class=nx>application</span><span class=w> </span><span class=nx>name</span><span class=p>,</span><span class=w> </span><span class=nx>in</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>context</span><span class=w> </span><span class=nx>of</span><span class=w> </span><span class=nx>Syslog</span><span class=w> </span><span class=nx>this</span><span class=w> </span><span class=nx>is</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>Message</span><span class=w> </span><span class=nx>ID</span><span class=p>.</span>
<a href=#__codelineno-6-4 id=__codelineno-6-4 name=__codelineno-6-4></a><span class=p>&lt;</span><span class=nx>SUBSYSTEM</span><span class=p>&gt;</span><span class=w>   </span><span class=o>-</span><span class=w> </span><span class=nx>SR</span><span class=w> </span><span class=nx>Linux</span><span class=w> </span><span class=nx>subsystem</span><span class=w> </span><span class=nx>name</span><span class=p>,</span><span class=w> </span><span class=nx>which</span><span class=w> </span><span class=nx>is</span><span class=w> </span><span class=nx>configured</span><span class=w> </span><span class=nx>under</span><span class=w> </span><span class=o>/</span><span class=nx>system</span><span class=o>/</span><span class=nx>logging</span><span class=o>/</span><span class=nx>remote</span><span class=o>-</span><span class=nx>server</span><span class=w> </span>
<a href=#__codelineno-6-5 id=__codelineno-6-5 name=__codelineno-6-5></a><span class=p>&lt;</span><span class=nx>PID</span><span class=p>&gt;</span><span class=w>         </span><span class=o>-</span><span class=w> </span><span class=nx>Process</span><span class=w> </span><span class=nx>ID</span><span class=p>.</span>
<a href=#__codelineno-6-6 id=__codelineno-6-6 name=__codelineno-6-6></a><span class=p>&lt;</span><span class=nx>THREAD_ID</span><span class=p>&gt;</span><span class=w>   </span><span class=o>-</span><span class=w> </span><span class=nx>Thread</span><span class=w> </span><span class=nx>ID</span><span class=p>.</span>
<a href=#__codelineno-6-7 id=__codelineno-6-7 name=__codelineno-6-7></a><span class=p>&lt;</span><span class=nx>SEQUENCE</span><span class=p>&gt;</span><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=nx>Sequence</span><span class=w> </span><span class=nx>number</span><span class=p>,</span><span class=w> </span><span class=nx>which</span><span class=w> </span><span class=nx>allows</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>reproduce</span><span class=w> </span><span class=nx>order</span><span class=w> </span><span class=nx>of</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>messages</span><span class=w> </span><span class=nx>sent</span><span class=w> </span><span class=nx>by</span><span class=w> </span><span class=nx>SR</span><span class=w> </span><span class=nx>Linux</span><span class=p>.</span>
<a href=#__codelineno-6-8 id=__codelineno-6-8 name=__codelineno-6-8></a><span class=p>&lt;</span><span class=nx>SERVERITY</span><span class=p>&gt;</span><span class=w>   </span><span class=o>-</span><span class=w> </span><span class=nx>A</span><span class=w> </span><span class=nx>singe</span><span class=w> </span><span class=nx>char</span><span class=w> </span><span class=nx>indicating</span><span class=w> </span><span class=nx>criticality</span><span class=w> </span><span class=nx>of</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>message</span><span class=w> </span><span class=p>(</span><span class=nx>I</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nx>infromational</span><span class=p>,</span><span class=w> </span><span class=nx>W</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nx>warning</span><span class=p>,</span><span class=w> </span><span class=nx>etc</span><span class=p>.)</span>
<a href=#__codelineno-6-9 id=__codelineno-6-9 name=__codelineno-6-9></a><span class=p>&lt;</span><span class=nx>MESSAGE</span><span class=p>&gt;</span><span class=w>     </span><span class=o>-</span><span class=w> </span><span class=nx>Application</span><span class=w> </span><span class=nx>free</span><span class=o>-</span><span class=nx>form</span><span class=w> </span><span class=nx>message</span><span class=w> </span><span class=nx>that</span><span class=w> </span><span class=nx>provides</span><span class=w> </span><span class=nx>information</span><span class=w> </span><span class=nx>about</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>event</span><span class=p>,</span><span class=w> </span><span class=nx>that</span><span class=w> </span><span class=nx>could</span><span class=w> </span><span class=nx>contain</span><span class=w> </span><span class=nx>network</span><span class=o>-</span><span class=nx>instance</span><span class=w> </span><span class=nx>name</span><span class=p>,</span><span class=w> </span>
<a href=#__codelineno-6-10 id=__codelineno-6-10 name=__codelineno-6-10></a><span class=w>                </span><span class=nx>like</span><span class=w> </span><span class=s>"Network-instance default"</span><span class=p>.</span>
</code></pre></div> <details class=tip> <summary>Dumping syslog messages sent to the remote-server</summary> <p>The format that rsyslog uses to send log messages to the remote destination differs from the default format used for <code>buffer</code> and <code>file</code> destination.</p> <p>To see the messages on the wire as they are being sent towards a remote syslog collector users can leverage <code>tcpdump</code> tool available on SR Linux:</p> <div class="language-srl highlight"><pre><span></span><code><a href=#__codelineno-7-1 id=__codelineno-7-1 name=__codelineno-7-1></a><span class=c>--{ running }--[  ]--</span>
<a href=#__codelineno-7-2 id=__codelineno-7-2 name=__codelineno-7-2></a>A:leaf1# <span class=n>bash </span>
<a href=#__codelineno-7-3 id=__codelineno-7-3 name=__codelineno-7-3></a><span class=err>[admin@leaf1 ~]$ tcpdump -vAnni any dst </span><span class=no>172.22.22.11</span>
<a href=#__codelineno-7-4 id=__codelineno-7-4 name=__codelineno-7-4></a><span class=err>tcpdump: listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length</span> <span class=no>262144</span> <span class=err>bytes</span>
<a href=#__codelineno-7-5 id=__codelineno-7-5 name=__codelineno-7-5></a>
<a href=#__codelineno-7-6 id=__codelineno-7-6 name=__codelineno-7-6></a><span class=err>23:21:04.782934 mgmt0.0 Out IP (tos 0x0, ttl 64, id 60086, offset 0, flags [DF], proto UDP </span>(<span class=no>17</span><span class=err>), length 141)</span>
<a href=#__codelineno-7-7 id=__codelineno-7-7 name=__codelineno-7-7></a><span class=err>    172.22.22.21.58170 &gt; 172.22.22.11.1514: UDP, length</span> <span class=no>113</span>
<a href=#__codelineno-7-8 id=__codelineno-7-8 name=__codelineno-7-8></a><span class=err>E.....@.@..\.........:...yo.&lt;181&gt;Feb </span> <span class=no>9</span> <span class=err>23:21:04 leaf1 sr_aaa_mgr: aaa|1599|1690|00010|N: Opened session for user admin from host </span><span class=no>172.22.22.1</span>
</code></pre></div> <p>The dump shows the message as it is on the wire and can be used to write parsers in Logstash.</p> </details> <h2 id=logstash>Logstash<a class=headerlink href=#logstash title="Permanent link">#</a></h2> <p><small> <a href=https://www.elastic.co/guide/en/logstash/7.17/introduction.html><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M0 3.75A.75.75 0 0 1 .75 3h7.497c1.566 0 2.945.8 3.751 2.014A4.496 4.496 0 0 1 15.75 3h7.5a.75.75 0 0 1 .75.75v15.063a.75.75 0 0 1-.755.75l-7.682-.052a3 3 0 0 0-2.142.878l-.89.891a.75.75 0 0 1-1.061 0l-.902-.901a3 3 0 0 0-2.121-.879H.75a.75.75 0 0 1-.75-.75v-15zm11.247 3.747a3 3 0 0 0-3-2.997H1.5V18h6.947a4.5 4.5 0 0 1 2.803.98l-.003-11.483zm1.503 11.485V7.5a3 3 0 0 1 3-3h6.75v13.558l-6.927-.047a4.5 4.5 0 0 0-2.823.971z" fill-rule=evenodd></path></svg></span> Logstash docs</a></small></p> <p>Now we are at a point when a raw syslog message has been generated by SR Linux and sent towards its first stop - Logstash.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>When preparing this post, savvy folks on Twitter <a href=https://twitter.com/xeraa/status/1624404576769130497>suggested</a> that Logstash might be an overkill for the scope of this lab. Instead, a lightweight Elastic-agent or Filebeat container could've been used.</p> <p>This is a sound idea for a sequel.</p> </div> <p>Logstash's task is to receive syslog messages, parse them into a structured document that Elasticsearch can digest, and pass it over.</p> <p>Logstash configuration includes four artifacts that we mount to the container:</p> <ol> <li><a href=https://github.com/srl-labs/srl-elk-lab/blob/main/elk/logstash/logstash.yml>Logstash config file</a> - main configuration file that contains global parameters of the Logstash.</li> <li><a href=https://github.com/srl-labs/srl-elk-lab/blob/main/elk/logstash/pipeline>Pipeline config</a> - pipeline configuration file.</li> <li><a href=https://github.com/srl-labs/srl-elk-lab/blob/main/elk/logstash/patterns>Patterns used in the pipeline</a> - regexp patterns that are used in the pipeline.</li> <li><a href=https://github.com/srl-labs/srl-elk-lab/blob/main/elk/logstash/index-template.json>Index template file</a> - a file that tells logstash which types to use for custom parsed fields.</li> </ol> <p>The most important Logstash file is the <a href=https://www.elastic.co/guide/en/logstash/7.17/configuration.html>pipeline config</a> file that defines inputs, filters, and outputs.</p> <h3 id=input>Input<a class=headerlink href=#input title="Permanent link">#</a></h3> <p>The input section, in our case, looks short and sweet - we take in syslog messages from the socket and apply tags to our messages:</p> <div class="language-r highlight"><span class=filename>pipeline input</span><pre><span></span><code><a href=#__codelineno-8-1 id=__codelineno-8-1 name=__codelineno-8-1></a><span class=n>input</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-8-2 id=__codelineno-8-2 name=__codelineno-8-2></a><span class=w>    </span><span class=n>syslog</span><span class=p>{</span>
<a href=#__codelineno-8-3 id=__codelineno-8-3 name=__codelineno-8-3></a><span class=w>        </span><span class=n>port</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=m>1514</span>
<a href=#__codelineno-8-4 id=__codelineno-8-4 name=__codelineno-8-4></a><span class=w>        </span><span class=n>use_labels</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>true</span>
<a href=#__codelineno-8-5 id=__codelineno-8-5 name=__codelineno-8-5></a><span class=w>        </span><span class=n>id</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"srlinux"</span>
<a href=#__codelineno-8-6 id=__codelineno-8-6 name=__codelineno-8-6></a><span class=w>        </span><span class=n>tags</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s>"syslog"</span><span class=p>,</span><span class=w> </span><span class=s>"srlinux"</span><span class=w> </span><span class=p>]</span>
<a href=#__codelineno-8-7 id=__codelineno-8-7 name=__codelineno-8-7></a><span class=w>        </span><span class=n>timezone</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"Europe/Rome"</span>
<a href=#__codelineno-8-8 id=__codelineno-8-8 name=__codelineno-8-8></a><span class=w>    </span><span class=p>}</span>
<a href=#__codelineno-8-9 id=__codelineno-8-9 name=__codelineno-8-9></a><span class=p>}</span>
</code></pre></div> <details class=note> <summary>Timezone, ECS and Syslog</summary> <p>Dealing with timezones is never easy, especially when Syslog RFC3164 timestamp format is like this:</p> <div class="language-text highlight"><pre><span></span><code><a href=#__codelineno-9-1 id=__codelineno-9-1 name=__codelineno-9-1></a>Feb 12 12:48:10
</code></pre></div> <p>Note that the timestamp (besides having no ms precision and year) lacks timezone information. Without the timezone information, we have to specifically set which timezone the received timestamps are in.</p> <p>Initially, we used Logstash's <code>date</code> filter plugin and provided timezone information there. The plugin worked in the following way:</p> <ol> <li>The timestamp format was parsed by the <code>date</code> plugin.</li> <li>If the timezone field was set in the plugin config, the time was adjusted accordingly.</li> <li>The resulting timestamp was converted to UTC/GMT format and pushed to the output.</li> </ol> <p>This worked well until we switched to using Elastic Common Schema (ECS) compatibility mode. After the switch, we noticed that the timestamps were not adjusted to the timezone anymore, resulting in the time being incorrect.</p> <p>We found out that by providing the timezone information in the Syslog input chain, we fixed this issue <a href=https://github.com/srl-labs/srl-elk-lab/commit/6f984a35cf68d0ea9791d268d0458493c266730a>moved the timezone info</a> from the date filter plugin to the input.</p> </details> <h3 id=filter>Filter<a class=headerlink href=#filter title="Permanent link">#</a></h3> <p>Most of the work is being done in the <strong>filter</strong> section, which is the pipeline's core. The ingested unstructured data is being parsed using Logstash's filter plugins, such as <a href=https://www.elastic.co/guide/en/logstash/7.17/plugins-filters-grok.html>grok</a>.</p> <div class="language-r highlight"><span class=filename>pipeline filter</span><pre><span></span><code><a href=#__codelineno-10-1 id=__codelineno-10-1 name=__codelineno-10-1></a><span class=n>filter</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-10-2 id=__codelineno-10-2 name=__codelineno-10-2></a><span class=w>    </span><span class=n>if</span><span class=w> </span><span class=s>"srlinux"</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=p>[</span><span class=n>tags</span><span class=p>]</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-10-3 id=__codelineno-10-3 name=__codelineno-10-3></a><span class=w>        </span><span class=n>grok</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-10-4 id=__codelineno-10-4 name=__codelineno-10-4></a><span class=w>            </span><span class=n>patterns_dir</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s>"/var/lib/logstash/patterns"</span><span class=w> </span><span class=p>]</span>
<a href=#__codelineno-10-5 id=__codelineno-10-5 name=__codelineno-10-5></a><span class=w>            </span><span class=n>match</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>"message"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"%{SRLPROC:subsystem}\|%{SRLPID:pid}\|%{SRLTHR:thread}\|%{SRLSEQ:sequence}\|%{SRLLVL:initial}:\s+(?&lt;message&gt;(.*))"</span><span class=w> </span><span class=p>}</span>
<a href=#__codelineno-10-6 id=__codelineno-10-6 name=__codelineno-10-6></a><span class=w>            </span><span class=n>overwrite</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s>"message"</span><span class=w> </span><span class=p>]</span>
<a href=#__codelineno-10-7 id=__codelineno-10-7 name=__codelineno-10-7></a><span class=w>            </span><span class=c1># srl container</span>
<a href=#__codelineno-10-8 id=__codelineno-10-8 name=__codelineno-10-8></a><span class=w>            </span><span class=n>add_field</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>"[srl][syslog][subsystem]"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"%{subsystem}"</span><span class=p>}</span>
<a href=#__codelineno-10-9 id=__codelineno-10-9 name=__codelineno-10-9></a><span class=w>            </span><span class=n>add_field</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>"[srl][syslog][pid]"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"%{pid}"</span><span class=p>}</span>
<a href=#__codelineno-10-10 id=__codelineno-10-10 name=__codelineno-10-10></a><span class=w>            </span><span class=n>add_field</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>"[srl][syslog][thread]"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"%{thread}"</span><span class=p>}</span>
<a href=#__codelineno-10-11 id=__codelineno-10-11 name=__codelineno-10-11></a><span class=w>            </span><span class=n>add_field</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>"[srl][syslog][sequence]"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"%{sequence}"</span><span class=p>}</span>
<a href=#__codelineno-10-12 id=__codelineno-10-12 name=__codelineno-10-12></a><span class=w>            </span><span class=n>add_field</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>"[srl][syslog][initial]"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"%{initial}"</span><span class=p>}</span>
<a href=#__codelineno-10-13 id=__codelineno-10-13 name=__codelineno-10-13></a><span class=w>            </span><span class=c1># set ECS version ecs.version</span>
<a href=#__codelineno-10-14 id=__codelineno-10-14 name=__codelineno-10-14></a><span class=w>            </span><span class=n>add_field</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>"[ecs][version]"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"1.12.2"</span><span class=w> </span><span class=p>}</span>
<a href=#__codelineno-10-15 id=__codelineno-10-15 name=__codelineno-10-15></a><span class=w>            </span><span class=c1># remove unused fields</span>
<a href=#__codelineno-10-16 id=__codelineno-10-16 name=__codelineno-10-16></a><span class=w>            </span><span class=n>remove_field</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s>"@version"</span><span class=p>,</span><span class=w> </span><span class=s>"event"</span><span class=p>,</span><span class=w> </span><span class=s>"service"</span><span class=p>,</span><span class=w> </span><span class=s>"subsystem"</span><span class=p>,</span><span class=w> </span><span class=s>"pid"</span><span class=p>,</span><span class=w> </span><span class=s>"thread"</span><span class=p>,</span><span class=w> </span><span class=s>"sequence"</span><span class=p>,</span><span class=w> </span><span class=s>"initial"</span><span class=w> </span><span class=p>]</span>
<a href=#__codelineno-10-17 id=__codelineno-10-17 name=__codelineno-10-17></a><span class=w>        </span><span class=p>}</span>
<a href=#__codelineno-10-18 id=__codelineno-10-18 name=__codelineno-10-18></a>
<a href=#__codelineno-10-19 id=__codelineno-10-19 name=__codelineno-10-19></a><span class=w>        </span><span class=n>date</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-10-20 id=__codelineno-10-20 name=__codelineno-10-20></a><span class=w>            </span><span class=n>match</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s>"timestamp"</span><span class=p>,</span>
<a href=#__codelineno-10-21 id=__codelineno-10-21 name=__codelineno-10-21></a><span class=w>            </span><span class=s>"MMM dd yyyy HH:mm:ss"</span><span class=p>,</span>
<a href=#__codelineno-10-22 id=__codelineno-10-22 name=__codelineno-10-22></a><span class=w>            </span><span class=s>"ISO8601"</span>
<a href=#__codelineno-10-23 id=__codelineno-10-23 name=__codelineno-10-23></a><span class=w>            </span><span class=p>]</span>
<a href=#__codelineno-10-24 id=__codelineno-10-24 name=__codelineno-10-24></a><span class=w>            </span><span class=n>timezone</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"Europe/Rome"</span>
<a href=#__codelineno-10-25 id=__codelineno-10-25 name=__codelineno-10-25></a><span class=w>        </span><span class=p>}</span>
<a href=#__codelineno-10-26 id=__codelineno-10-26 name=__codelineno-10-26></a><span class=w>    </span><span class=p>}</span>
<a href=#__codelineno-10-27 id=__codelineno-10-27 name=__codelineno-10-27></a><span class=p>}</span>
</code></pre></div> <p>Note that when parsing the syslog messages, we leverage <a href=https://www.elastic.co/guide/en/ecs/1.12/ecs-reference.html>Elastic Common Schema v1 (ECS)</a> which unifies the way fields are represented in the output document<sup id=fnref:5><a class=footnote-ref href=#fn:5>5</a></sup>. Fields such as <a href=https://www.elastic.co/guide/en/ecs/current/ecs-log.html#field-log-level>log</a> and <a href=https://www.elastic.co/guide/en/ecs/current/ecs-host.html>host</a> are used by ECS to nest data pertaining to the logs and host objects. ECS aims to unify message fields used from various applications and thus provide a streamlined search and visualization experience.</p> <p>For SR Linux-specific fields that do not map into the ECS, we use the custom <code>srl</code> object where we put nested fields such as <code>pid</code>, <code>thread</code>, etc.</p> <p>In the filter section, we also parse the date parameter of the syslog message by providing a list of parsing patterns.</p> <h3 id=output>Output<a class=headerlink href=#output title="Permanent link">#</a></h3> <p>Once the parsing is done, Logstash feeds the structured documents to Elasticsearch as instructed by the output plugin:</p> <div class="language-r highlight"><span class=filename>pipeline output</span><pre><span></span><code><a href=#__codelineno-11-1 id=__codelineno-11-1 name=__codelineno-11-1></a><span class=n>output</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-11-2 id=__codelineno-11-2 name=__codelineno-11-2></a><span class=w>    </span><span class=n>if</span><span class=w> </span><span class=s>"srlinux"</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=p>[</span><span class=n>tags</span><span class=p>]</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-11-3 id=__codelineno-11-3 name=__codelineno-11-3></a><span class=w>        </span><span class=n>if</span><span class=w> </span><span class=s>"_grokparsefailure"</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=p>[</span><span class=n>tags</span><span class=p>]</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-11-4 id=__codelineno-11-4 name=__codelineno-11-4></a><span class=w>            </span><span class=n>file</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-11-5 id=__codelineno-11-5 name=__codelineno-11-5></a><span class=w>                </span><span class=n>path</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"/srl/fail_to_parse_srl.log"</span>
<a href=#__codelineno-11-6 id=__codelineno-11-6 name=__codelineno-11-6></a><span class=w>                </span><span class=n>codec</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>rubydebug</span>
<a href=#__codelineno-11-7 id=__codelineno-11-7 name=__codelineno-11-7></a><span class=w>            </span><span class=p>}</span>
<a href=#__codelineno-11-8 id=__codelineno-11-8 name=__codelineno-11-8></a><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=n>else</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-11-9 id=__codelineno-11-9 name=__codelineno-11-9></a><span class=w>            </span><span class=n>elasticsearch</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-11-10 id=__codelineno-11-10 name=__codelineno-11-10></a><span class=w>                </span><span class=n>hosts</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=s>"http://elastic"</span><span class=p>]</span>
<a href=#__codelineno-11-11 id=__codelineno-11-11 name=__codelineno-11-11></a><span class=w>                </span><span class=n>ssl</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>false</span>
<a href=#__codelineno-11-12 id=__codelineno-11-12 name=__codelineno-11-12></a><span class=w>                </span><span class=n>index</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"fabric-logs-%{+YYYY.MM.dd}"</span>
<a href=#__codelineno-11-13 id=__codelineno-11-13 name=__codelineno-11-13></a><span class=w>                </span><span class=n>manage_template</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>true</span>
<a href=#__codelineno-11-14 id=__codelineno-11-14 name=__codelineno-11-14></a><span class=w>                </span><span class=n>template</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"/tmp/index-template.json"</span>
<a href=#__codelineno-11-15 id=__codelineno-11-15 name=__codelineno-11-15></a><span class=w>                </span><span class=n>template_name</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"fabric-template"</span>
<a href=#__codelineno-11-16 id=__codelineno-11-16 name=__codelineno-11-16></a><span class=w>                </span><span class=n>template_overwrite</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>true</span>
<a href=#__codelineno-11-17 id=__codelineno-11-17 name=__codelineno-11-17></a><span class=w>                </span><span class=n>id</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"fabric-logs"</span>
<a href=#__codelineno-11-18 id=__codelineno-11-18 name=__codelineno-11-18></a><span class=w>            </span><span class=p>}</span>
<a href=#__codelineno-11-19 id=__codelineno-11-19 name=__codelineno-11-19></a><span class=w>            </span><span class=n>stdout</span><span class=w> </span><span class=p>{}</span>
<a href=#__codelineno-11-20 id=__codelineno-11-20 name=__codelineno-11-20></a><span class=w>        </span><span class=p>}</span>
<a href=#__codelineno-11-21 id=__codelineno-11-21 name=__codelineno-11-21></a><span class=w>    </span><span class=p>}</span>
<a href=#__codelineno-11-22 id=__codelineno-11-22 name=__codelineno-11-22></a><span class=p>}</span>
</code></pre></div> <p>In the output section, we set the address of the elastic server, the desired index name, and the index template file to use.</p> <p>The <a href=https://github.com/srl-labs/srl-elk-lab/blob/main/elk/logstash/index-template.json><code>index-template.json</code></a> file contains the types that we, as designers of the pipeline, want Elastic to use when indexing and storing documents.</p> <p>The resulting outgoing JSON document generated at the end of the Logstash pipeline looks similar to that example:</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>JSON</label><label for=__tabbed_1_2>rdebug</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-json highlight"><pre><span></span><code><a href=#__codelineno-12-1 id=__codelineno-12-1 name=__codelineno-12-1></a><span class=p>{</span>
<a href=#__codelineno-12-2 id=__codelineno-12-2 name=__codelineno-12-2></a><span class=w>    </span><span class=nt>"@timestamp"</span><span class=p>:</span><span class=w> </span><span class=s2>"2023-02-11T16:29:25.000Z"</span><span class=p>,</span>
<a href=#__codelineno-12-3 id=__codelineno-12-3 name=__codelineno-12-3></a><span class=w>    </span><span class=nt>"host"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-12-4 id=__codelineno-12-4 name=__codelineno-12-4></a><span class=w>        </span><span class=nt>"ip"</span><span class=p>:</span><span class=w> </span><span class=s2>"172.22.22.21"</span><span class=p>,</span>
<a href=#__codelineno-12-5 id=__codelineno-12-5 name=__codelineno-12-5></a><span class=w>        </span><span class=nt>"hostname"</span><span class=p>:</span><span class=w> </span><span class=s2>"leaf1"</span>
<a href=#__codelineno-12-6 id=__codelineno-12-6 name=__codelineno-12-6></a><span class=w>    </span><span class=p>},</span>
<a href=#__codelineno-12-7 id=__codelineno-12-7 name=__codelineno-12-7></a><span class=w>    </span><span class=nt>"ecs"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-12-8 id=__codelineno-12-8 name=__codelineno-12-8></a><span class=w>        </span><span class=nt>"version"</span><span class=p>:</span><span class=w> </span><span class=s2>"1.12.2"</span>
<a href=#__codelineno-12-9 id=__codelineno-12-9 name=__codelineno-12-9></a><span class=w>    </span><span class=p>},</span>
<a href=#__codelineno-12-10 id=__codelineno-12-10 name=__codelineno-12-10></a><span class=w>    </span><span class=nt>"log"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-12-11 id=__codelineno-12-11 name=__codelineno-12-11></a><span class=w>        </span><span class=nt>"syslog"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-12-12 id=__codelineno-12-12 name=__codelineno-12-12></a><span class=w>            </span><span class=nt>"priority"</span><span class=p>:</span><span class=w> </span><span class=mi>181</span><span class=p>,</span>
<a href=#__codelineno-12-13 id=__codelineno-12-13 name=__codelineno-12-13></a><span class=w>            </span><span class=nt>"facility"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-12-14 id=__codelineno-12-14 name=__codelineno-12-14></a><span class=w>                </span><span class=nt>"code"</span><span class=p>:</span><span class=w> </span><span class=mi>22</span><span class=p>,</span>
<a href=#__codelineno-12-15 id=__codelineno-12-15 name=__codelineno-12-15></a><span class=w>                </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"local6"</span>
<a href=#__codelineno-12-16 id=__codelineno-12-16 name=__codelineno-12-16></a><span class=w>            </span><span class=p>},</span>
<a href=#__codelineno-12-17 id=__codelineno-12-17 name=__codelineno-12-17></a><span class=w>            </span><span class=nt>"severity"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-12-18 id=__codelineno-12-18 name=__codelineno-12-18></a><span class=w>                </span><span class=nt>"code"</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=p>,</span>
<a href=#__codelineno-12-19 id=__codelineno-12-19 name=__codelineno-12-19></a><span class=w>                </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"Notice"</span>
<a href=#__codelineno-12-20 id=__codelineno-12-20 name=__codelineno-12-20></a><span class=w>            </span><span class=p>}</span>
<a href=#__codelineno-12-21 id=__codelineno-12-21 name=__codelineno-12-21></a><span class=w>        </span><span class=p>}</span>
<a href=#__codelineno-12-22 id=__codelineno-12-22 name=__codelineno-12-22></a><span class=w>    </span><span class=p>},</span>
<a href=#__codelineno-12-23 id=__codelineno-12-23 name=__codelineno-12-23></a><span class=w>    </span><span class=nt>"process"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-12-24 id=__codelineno-12-24 name=__codelineno-12-24></a><span class=w>        </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"sr_aaa_mgr"</span>
<a href=#__codelineno-12-25 id=__codelineno-12-25 name=__codelineno-12-25></a><span class=w>    </span><span class=p>},</span>
<a href=#__codelineno-12-26 id=__codelineno-12-26 name=__codelineno-12-26></a><span class=w>    </span><span class=nt>"tags"</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a href=#__codelineno-12-27 id=__codelineno-12-27 name=__codelineno-12-27></a><span class=w>        </span><span class=s2>"syslog"</span><span class=p>,</span>
<a href=#__codelineno-12-28 id=__codelineno-12-28 name=__codelineno-12-28></a><span class=w>        </span><span class=s2>"srlinux"</span>
<a href=#__codelineno-12-29 id=__codelineno-12-29 name=__codelineno-12-29></a><span class=w>    </span><span class=p>],</span>
<a href=#__codelineno-12-30 id=__codelineno-12-30 name=__codelineno-12-30></a><span class=w>    </span><span class=nt>"message"</span><span class=p>:</span><span class=w> </span><span class=s2>"Closed session for user admin from host 172.22.22.1"</span><span class=p>,</span>
<a href=#__codelineno-12-31 id=__codelineno-12-31 name=__codelineno-12-31></a><span class=w>    </span><span class=nt>"srl"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-12-32 id=__codelineno-12-32 name=__codelineno-12-32></a><span class=w>        </span><span class=nt>"syslog"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-12-33 id=__codelineno-12-33 name=__codelineno-12-33></a><span class=w>            </span><span class=nt>"thread"</span><span class=p>:</span><span class=w> </span><span class=s2>"1681"</span><span class=p>,</span>
<a href=#__codelineno-12-34 id=__codelineno-12-34 name=__codelineno-12-34></a><span class=w>            </span><span class=nt>"sequence"</span><span class=p>:</span><span class=w> </span><span class=s2>"00007"</span><span class=p>,</span>
<a href=#__codelineno-12-35 id=__codelineno-12-35 name=__codelineno-12-35></a><span class=w>            </span><span class=nt>"initial"</span><span class=p>:</span><span class=w> </span><span class=s2>"N"</span><span class=p>,</span>
<a href=#__codelineno-12-36 id=__codelineno-12-36 name=__codelineno-12-36></a><span class=w>            </span><span class=nt>"pid"</span><span class=p>:</span><span class=w> </span><span class=s2>"1630"</span><span class=p>,</span>
<a href=#__codelineno-12-37 id=__codelineno-12-37 name=__codelineno-12-37></a><span class=w>            </span><span class=nt>"subsystem"</span><span class=p>:</span><span class=w> </span><span class=s2>"aaa"</span>
<a href=#__codelineno-12-38 id=__codelineno-12-38 name=__codelineno-12-38></a><span class=w>        </span><span class=p>}</span>
<a href=#__codelineno-12-39 id=__codelineno-12-39 name=__codelineno-12-39></a><span class=w>    </span><span class=p>}</span>
<a href=#__codelineno-12-40 id=__codelineno-12-40 name=__codelineno-12-40></a><span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <p>The <code>ruby debug</code> format is seen in the log of the logstash container as enabled by the <code>stdout</code> output for debug purposes. <div class="language-r highlight"><pre><span></span><code><a href=#__codelineno-13-1 id=__codelineno-13-1 name=__codelineno-13-1></a><span class=p>{</span>
<a href=#__codelineno-13-2 id=__codelineno-13-2 name=__codelineno-13-2></a><span class=w>    </span><span class=s>"@timestamp"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=m>2023-02-11</span><span class=n>T16</span><span class=o>:</span><span class=m>24</span><span class=o>:</span><span class=m>25.000</span><span class=n>Z</span><span class=p>,</span>
<a href=#__codelineno-13-3 id=__codelineno-13-3 name=__codelineno-13-3></a><span class=w>        </span><span class=s>"host"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-13-4 id=__codelineno-13-4 name=__codelineno-13-4></a><span class=w>            </span><span class=s>"ip"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"172.22.22.21"</span><span class=p>,</span>
<a href=#__codelineno-13-5 id=__codelineno-13-5 name=__codelineno-13-5></a><span class=w>        </span><span class=s>"hostname"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"leaf1"</span>
<a href=#__codelineno-13-6 id=__codelineno-13-6 name=__codelineno-13-6></a><span class=w>    </span><span class=p>},</span>
<a href=#__codelineno-13-7 id=__codelineno-13-7 name=__codelineno-13-7></a><span class=w>        </span><span class=s>"ecs"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-13-8 id=__codelineno-13-8 name=__codelineno-13-8></a><span class=w>        </span><span class=s>"version"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"1.12.2"</span>
<a href=#__codelineno-13-9 id=__codelineno-13-9 name=__codelineno-13-9></a><span class=w>    </span><span class=p>},</span>
<a href=#__codelineno-13-10 id=__codelineno-13-10 name=__codelineno-13-10></a><span class=w>        </span><span class=s>"log"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-13-11 id=__codelineno-13-11 name=__codelineno-13-11></a><span class=w>        </span><span class=s>"syslog"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-13-12 id=__codelineno-13-12 name=__codelineno-13-12></a><span class=w>            </span><span class=s>"priority"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=m>181</span><span class=p>,</span>
<a href=#__codelineno-13-13 id=__codelineno-13-13 name=__codelineno-13-13></a><span class=w>            </span><span class=s>"facility"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-13-14 id=__codelineno-13-14 name=__codelineno-13-14></a><span class=w>                </span><span class=s>"code"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=m>22</span><span class=p>,</span>
<a href=#__codelineno-13-15 id=__codelineno-13-15 name=__codelineno-13-15></a><span class=w>                </span><span class=s>"name"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"local6"</span>
<a href=#__codelineno-13-16 id=__codelineno-13-16 name=__codelineno-13-16></a><span class=w>            </span><span class=p>},</span>
<a href=#__codelineno-13-17 id=__codelineno-13-17 name=__codelineno-13-17></a><span class=w>            </span><span class=s>"severity"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-13-18 id=__codelineno-13-18 name=__codelineno-13-18></a><span class=w>                </span><span class=s>"code"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=m>5</span><span class=p>,</span>
<a href=#__codelineno-13-19 id=__codelineno-13-19 name=__codelineno-13-19></a><span class=w>                </span><span class=s>"name"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"Notice"</span>
<a href=#__codelineno-13-20 id=__codelineno-13-20 name=__codelineno-13-20></a><span class=w>            </span><span class=p>}</span>
<a href=#__codelineno-13-21 id=__codelineno-13-21 name=__codelineno-13-21></a><span class=w>        </span><span class=p>}</span>
<a href=#__codelineno-13-22 id=__codelineno-13-22 name=__codelineno-13-22></a><span class=w>    </span><span class=p>},</span>
<a href=#__codelineno-13-23 id=__codelineno-13-23 name=__codelineno-13-23></a><span class=w>    </span><span class=s>"process"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-13-24 id=__codelineno-13-24 name=__codelineno-13-24></a><span class=w>        </span><span class=s>"name"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"sr_aaa_mgr"</span>
<a href=#__codelineno-13-25 id=__codelineno-13-25 name=__codelineno-13-25></a><span class=w>    </span><span class=p>},</span>
<a href=#__codelineno-13-26 id=__codelineno-13-26 name=__codelineno-13-26></a><span class=w>        </span><span class=s>"tags"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span>
<a href=#__codelineno-13-27 id=__codelineno-13-27 name=__codelineno-13-27></a><span class=w>        </span><span class=p>[</span><span class=m>0</span><span class=p>]</span><span class=w> </span><span class=s>"syslog"</span><span class=p>,</span>
<a href=#__codelineno-13-28 id=__codelineno-13-28 name=__codelineno-13-28></a><span class=w>        </span><span class=p>[</span><span class=m>1</span><span class=p>]</span><span class=w> </span><span class=s>"srlinux"</span>
<a href=#__codelineno-13-29 id=__codelineno-13-29 name=__codelineno-13-29></a><span class=w>    </span><span class=p>],</span>
<a href=#__codelineno-13-30 id=__codelineno-13-30 name=__codelineno-13-30></a><span class=w>    </span><span class=s>"message"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"Opened session for user admin from host 172.22.22.1"</span><span class=p>,</span>
<a href=#__codelineno-13-31 id=__codelineno-13-31 name=__codelineno-13-31></a><span class=w>        </span><span class=s>"srl"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-13-32 id=__codelineno-13-32 name=__codelineno-13-32></a><span class=w>        </span><span class=s>"syslog"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-13-33 id=__codelineno-13-33 name=__codelineno-13-33></a><span class=w>            </span><span class=s>"thread"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"1681"</span><span class=p>,</span>
<a href=#__codelineno-13-34 id=__codelineno-13-34 name=__codelineno-13-34></a><span class=w>            </span><span class=s>"sequence"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"00006"</span><span class=p>,</span>
<a href=#__codelineno-13-35 id=__codelineno-13-35 name=__codelineno-13-35></a><span class=w>            </span><span class=s>"initial"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"N"</span><span class=p>,</span>
<a href=#__codelineno-13-36 id=__codelineno-13-36 name=__codelineno-13-36></a><span class=w>                </span><span class=s>"pid"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"1630"</span><span class=p>,</span>
<a href=#__codelineno-13-37 id=__codelineno-13-37 name=__codelineno-13-37></a><span class=w>            </span><span class=s>"subsystem"</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s>"aaa"</span>
<a href=#__codelineno-13-38 id=__codelineno-13-38 name=__codelineno-13-38></a><span class=w>        </span><span class=p>}</span>
<a href=#__codelineno-13-39 id=__codelineno-13-39 name=__codelineno-13-39></a><span class=w>    </span><span class=p>}</span>
<a href=#__codelineno-13-40 id=__codelineno-13-40 name=__codelineno-13-40></a><span class=p>}</span>
</code></pre></div></p> </div> </div> </div> <h3 id=debugging>Debugging<a class=headerlink href=#debugging title="Permanent link">#</a></h3> <p>When developing Logstash filters, it is unavoidable to make errors on the first try. There are a couple of tricks worth sharing that can assist in making your life easier.</p> <p>First, when developing the <code>grok</code> patch patterns, it might be helpful to run a simulation using the Dev Tools provided by Kibana to verify that you actually matched the required fields:</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-width=100% href=https://gitlab.com/rdodin/pics/-/wikis/uploads/2809fafd7d5a05ed9a59ff6226801432/image.png><img alt=grok-simulation class=img-shadow src=https://gitlab.com/rdodin/pics/-/wikis/uploads/2809fafd7d5a05ed9a59ff6226801432/image.png></a></p> <p>In the event of a parsing failure, Logstash will dump messages it couldn't parse to a file that users can see at <code>./elk/logstash/logs/fail_to_parse_srl.log</code>.</p> <p>In addition to the parsing log, Logstash emits application logs that may provide hints on what went wrong in case of failures as well as outputting events at the end of the pipeline to stdout. You can read this log using <code>docker logs -f logstash</code>.</p> <h2 id=elasticsearch>Elasticsearch<a class=headerlink href=#elasticsearch title="Permanent link">#</a></h2> <p><small> <a href=https://www.elastic.co/guide/en/elasticsearch/reference/7.17/index.html><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M0 3.75A.75.75 0 0 1 .75 3h7.497c1.566 0 2.945.8 3.751 2.014A4.496 4.496 0 0 1 15.75 3h7.5a.75.75 0 0 1 .75.75v15.063a.75.75 0 0 1-.755.75l-7.682-.052a3 3 0 0 0-2.142.878l-.89.891a.75.75 0 0 1-1.061 0l-.902-.901a3 3 0 0 0-2.121-.879H.75a.75.75 0 0 1-.75-.75v-15zm11.247 3.747a3 3 0 0 0-3-2.997H1.5V18h6.947a4.5 4.5 0 0 1 2.803.98l-.003-11.483zm1.503 11.485V7.5a3 3 0 0 1 3-3h6.75v13.558l-6.927-.047a4.5 4.5 0 0 0-2.823.971z" fill-rule=evenodd></path></svg></span> Elastic docs</a></small></p> <p>Elasticsearch is the distributed search and analytics engine at the heart of the Elastic Stack. Logstash and Beats facilitate collecting, aggregating, and enriching your data and storing it in Elasticsearch. Kibana enables you to interactively explore, visualize, and share insights into your data and manage and monitor the stack. Elasticsearch is where the indexing, search, and analysis magic happens.</p> <h3 id=index-template-and-mappings>Index Template and Mappings<a class=headerlink href=#index-template-and-mappings title="Permanent link">#</a></h3> <p>Upon receiving a JSON document from Logstash, Elasticsearch indexes it and stores it in an index structure. When the index is created, Elastic makes the best guess about which types to use for each of the fields belonging to the JSON document. Sometimes the guess is accurate, but in many cases, the auto-guessing misses choosing the right type and, for instance, selects <code>text</code> type for an IP address.</p> <p>Ultimately, however, you know more about your data and how you want to use it than Elasticsearch can. You can define rules to control dynamic mapping and explicitly define mappings to take full control of how fields are stored and indexed. To enforce the correct types for the data we provided the Index Template as explained in the <a href=#output>Logstash output</a> section.</p> <h3 id=querying-the-index>Querying the index<a class=headerlink href=#querying-the-index title="Permanent link">#</a></h3> <p>To see the documents stored in the Elastic index we can leverage Elastic API using <code>curl</code> or Dev Tools panel of Kibana.</p> <details class=example> <summary>Query examples with <code>curl</code></summary> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>Listing all documents with <code>curl</code></label><label for=__tabbed_2_2>Searching for a particular document with <code>curl</code></label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-json highlight"><pre><span></span><code><a href=#__codelineno-14-1 id=__codelineno-14-1 name=__codelineno-14-1></a><span class=err>❯</span><span class=w> </span><span class=err>curl</span><span class=w> </span><span class=mi>-</span><span class=err>s</span><span class=w> </span><span class=s2>"http://localhost:9200/fabric-logs-*/_search"</span><span class=w> </span><span class=mi>-</span><span class=err>H</span><span class=w> </span><span class=err>'Co</span><span class=kc>ntent</span><span class=mi>-</span><span class=err>Type</span><span class=p>:</span><span class=w> </span><span class=err>applica</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=err>/jso</span><span class=kc>n</span><span class=err>'</span><span class=w> </span><span class=mi>-</span><span class=err>d'</span>
<a href=#__codelineno-14-2 id=__codelineno-14-2 name=__codelineno-14-2></a><span class=p>{</span>
<a href=#__codelineno-14-3 id=__codelineno-14-3 name=__codelineno-14-3></a><span class=w>  </span><span class=nt>"query"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-4 id=__codelineno-14-4 name=__codelineno-14-4></a><span class=w>    </span><span class=nt>"match_all"</span><span class=p>:</span><span class=w> </span><span class=p>{}</span>
<a href=#__codelineno-14-5 id=__codelineno-14-5 name=__codelineno-14-5></a><span class=w>  </span><span class=p>}</span>
<a href=#__codelineno-14-6 id=__codelineno-14-6 name=__codelineno-14-6></a><span class=p>}</span><span class=err>'</span><span class=w> </span><span class=err>|</span><span class=w> </span><span class=err>jq</span>
<a href=#__codelineno-14-7 id=__codelineno-14-7 name=__codelineno-14-7></a>
<a href=#__codelineno-14-8 id=__codelineno-14-8 name=__codelineno-14-8></a><span class=p>{</span>
<a href=#__codelineno-14-9 id=__codelineno-14-9 name=__codelineno-14-9></a><span class=w>  </span><span class=nt>"took"</span><span class=p>:</span><span class=w> </span><span class=mi>8</span><span class=p>,</span>
<a href=#__codelineno-14-10 id=__codelineno-14-10 name=__codelineno-14-10></a><span class=w>  </span><span class=nt>"timed_out"</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<a href=#__codelineno-14-11 id=__codelineno-14-11 name=__codelineno-14-11></a><span class=w>  </span><span class=nt>"_shards"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-12 id=__codelineno-14-12 name=__codelineno-14-12></a><span class=w>    </span><span class=nt>"total"</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<a href=#__codelineno-14-13 id=__codelineno-14-13 name=__codelineno-14-13></a><span class=w>    </span><span class=nt>"successful"</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<a href=#__codelineno-14-14 id=__codelineno-14-14 name=__codelineno-14-14></a><span class=w>    </span><span class=nt>"skipped"</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<a href=#__codelineno-14-15 id=__codelineno-14-15 name=__codelineno-14-15></a><span class=w>    </span><span class=nt>"failed"</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
<a href=#__codelineno-14-16 id=__codelineno-14-16 name=__codelineno-14-16></a><span class=w>  </span><span class=p>},</span>
<a href=#__codelineno-14-17 id=__codelineno-14-17 name=__codelineno-14-17></a><span class=w>  </span><span class=nt>"hits"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-18 id=__codelineno-14-18 name=__codelineno-14-18></a><span class=w>    </span><span class=nt>"total"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-19 id=__codelineno-14-19 name=__codelineno-14-19></a><span class=w>      </span><span class=nt>"value"</span><span class=p>:</span><span class=w> </span><span class=mi>66</span><span class=p>,</span>
<a href=#__codelineno-14-20 id=__codelineno-14-20 name=__codelineno-14-20></a><span class=w>      </span><span class=nt>"relation"</span><span class=p>:</span><span class=w> </span><span class=s2>"eq"</span>
<a href=#__codelineno-14-21 id=__codelineno-14-21 name=__codelineno-14-21></a><span class=w>    </span><span class=p>},</span>
<a href=#__codelineno-14-22 id=__codelineno-14-22 name=__codelineno-14-22></a><span class=w>    </span><span class=nt>"max_score"</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<a href=#__codelineno-14-23 id=__codelineno-14-23 name=__codelineno-14-23></a><span class=w>    </span><span class=nt>"hits"</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a href=#__codelineno-14-24 id=__codelineno-14-24 name=__codelineno-14-24></a><span class=w>      </span><span class=p>{</span>
<a href=#__codelineno-14-25 id=__codelineno-14-25 name=__codelineno-14-25></a><span class=w>        </span><span class=nt>"_index"</span><span class=p>:</span><span class=w> </span><span class=s2>"fabric-logs-2023.02.12"</span><span class=p>,</span>
<a href=#__codelineno-14-26 id=__codelineno-14-26 name=__codelineno-14-26></a><span class=w>        </span><span class=nt>"_type"</span><span class=p>:</span><span class=w> </span><span class=s2>"_doc"</span><span class=p>,</span>
<a href=#__codelineno-14-27 id=__codelineno-14-27 name=__codelineno-14-27></a><span class=w>        </span><span class=nt>"_id"</span><span class=p>:</span><span class=w> </span><span class=s2>"-AQDRoYB-MNGUHTecRIg"</span><span class=p>,</span>
<a href=#__codelineno-14-28 id=__codelineno-14-28 name=__codelineno-14-28></a><span class=w>        </span><span class=nt>"_score"</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<a href=#__codelineno-14-29 id=__codelineno-14-29 name=__codelineno-14-29></a><span class=w>        </span><span class=nt>"_source"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-30 id=__codelineno-14-30 name=__codelineno-14-30></a><span class=w>          </span><span class=nt>"host"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-31 id=__codelineno-14-31 name=__codelineno-14-31></a><span class=w>            </span><span class=nt>"ip"</span><span class=p>:</span><span class=w> </span><span class=s2>"172.22.22.21"</span><span class=p>,</span>
<a href=#__codelineno-14-32 id=__codelineno-14-32 name=__codelineno-14-32></a><span class=w>            </span><span class=nt>"hostname"</span><span class=p>:</span><span class=w> </span><span class=s2>"leaf1"</span>
<a href=#__codelineno-14-33 id=__codelineno-14-33 name=__codelineno-14-33></a><span class=w>          </span><span class=p>},</span>
<a href=#__codelineno-14-34 id=__codelineno-14-34 name=__codelineno-14-34></a><span class=w>          </span><span class=nt>"ecs"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-35 id=__codelineno-14-35 name=__codelineno-14-35></a><span class=w>            </span><span class=nt>"version"</span><span class=p>:</span><span class=w> </span><span class=s2>"1.12.2"</span>
<a href=#__codelineno-14-36 id=__codelineno-14-36 name=__codelineno-14-36></a><span class=w>          </span><span class=p>},</span>
<a href=#__codelineno-14-37 id=__codelineno-14-37 name=__codelineno-14-37></a><span class=w>          </span><span class=nt>"@timestamp"</span><span class=p>:</span><span class=w> </span><span class=s2>"2023-02-12T14:24:36.000Z"</span><span class=p>,</span>
<a href=#__codelineno-14-38 id=__codelineno-14-38 name=__codelineno-14-38></a><span class=w>          </span><span class=nt>"process"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-39 id=__codelineno-14-39 name=__codelineno-14-39></a><span class=w>            </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"sr_aaa_mgr"</span>
<a href=#__codelineno-14-40 id=__codelineno-14-40 name=__codelineno-14-40></a><span class=w>          </span><span class=p>},</span>
<a href=#__codelineno-14-41 id=__codelineno-14-41 name=__codelineno-14-41></a><span class=w>          </span><span class=nt>"message"</span><span class=p>:</span><span class=w> </span><span class=s2>"Closed session for user admin from host 172.22.22.1"</span><span class=p>,</span>
<a href=#__codelineno-14-42 id=__codelineno-14-42 name=__codelineno-14-42></a><span class=w>          </span><span class=nt>"tags"</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a href=#__codelineno-14-43 id=__codelineno-14-43 name=__codelineno-14-43></a><span class=w>            </span><span class=s2>"syslog"</span><span class=p>,</span>
<a href=#__codelineno-14-44 id=__codelineno-14-44 name=__codelineno-14-44></a><span class=w>            </span><span class=s2>"srlinux"</span>
<a href=#__codelineno-14-45 id=__codelineno-14-45 name=__codelineno-14-45></a><span class=w>          </span><span class=p>],</span>
<a href=#__codelineno-14-46 id=__codelineno-14-46 name=__codelineno-14-46></a><span class=w>          </span><span class=nt>"srl"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-47 id=__codelineno-14-47 name=__codelineno-14-47></a><span class=w>            </span><span class=nt>"syslog"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-48 id=__codelineno-14-48 name=__codelineno-14-48></a><span class=w>              </span><span class=nt>"initial"</span><span class=p>:</span><span class=w> </span><span class=s2>"N"</span><span class=p>,</span>
<a href=#__codelineno-14-49 id=__codelineno-14-49 name=__codelineno-14-49></a><span class=w>              </span><span class=nt>"subsystem"</span><span class=p>:</span><span class=w> </span><span class=s2>"aaa"</span><span class=p>,</span>
<a href=#__codelineno-14-50 id=__codelineno-14-50 name=__codelineno-14-50></a><span class=w>              </span><span class=nt>"pid"</span><span class=p>:</span><span class=w> </span><span class=s2>"1227"</span><span class=p>,</span>
<a href=#__codelineno-14-51 id=__codelineno-14-51 name=__codelineno-14-51></a><span class=w>              </span><span class=nt>"thread"</span><span class=p>:</span><span class=w> </span><span class=s2>"1260"</span><span class=p>,</span>
<a href=#__codelineno-14-52 id=__codelineno-14-52 name=__codelineno-14-52></a><span class=w>              </span><span class=nt>"sequence"</span><span class=p>:</span><span class=w> </span><span class=s2>"00011"</span>
<a href=#__codelineno-14-53 id=__codelineno-14-53 name=__codelineno-14-53></a><span class=w>            </span><span class=p>}</span>
<a href=#__codelineno-14-54 id=__codelineno-14-54 name=__codelineno-14-54></a><span class=w>          </span><span class=p>},</span>
<a href=#__codelineno-14-55 id=__codelineno-14-55 name=__codelineno-14-55></a><span class=w>          </span><span class=nt>"log"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-56 id=__codelineno-14-56 name=__codelineno-14-56></a><span class=w>            </span><span class=nt>"syslog"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-57 id=__codelineno-14-57 name=__codelineno-14-57></a><span class=w>              </span><span class=nt>"severity"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-58 id=__codelineno-14-58 name=__codelineno-14-58></a><span class=w>                </span><span class=nt>"code"</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=p>,</span>
<a href=#__codelineno-14-59 id=__codelineno-14-59 name=__codelineno-14-59></a><span class=w>                </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"Notice"</span>
<a href=#__codelineno-14-60 id=__codelineno-14-60 name=__codelineno-14-60></a><span class=w>              </span><span class=p>},</span>
<a href=#__codelineno-14-61 id=__codelineno-14-61 name=__codelineno-14-61></a><span class=w>              </span><span class=nt>"facility"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-14-62 id=__codelineno-14-62 name=__codelineno-14-62></a><span class=w>                </span><span class=nt>"code"</span><span class=p>:</span><span class=w> </span><span class=mi>22</span><span class=p>,</span>
<a href=#__codelineno-14-63 id=__codelineno-14-63 name=__codelineno-14-63></a><span class=w>                </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"local6"</span>
<a href=#__codelineno-14-64 id=__codelineno-14-64 name=__codelineno-14-64></a><span class=w>              </span><span class=p>},</span>
<a href=#__codelineno-14-65 id=__codelineno-14-65 name=__codelineno-14-65></a><span class=w>              </span><span class=nt>"priority"</span><span class=p>:</span><span class=w> </span><span class=mi>181</span>
<a href=#__codelineno-14-66 id=__codelineno-14-66 name=__codelineno-14-66></a><span class=w>            </span><span class=p>}</span>
<a href=#__codelineno-14-67 id=__codelineno-14-67 name=__codelineno-14-67></a><span class=w>          </span><span class=p>}</span>
<a href=#__codelineno-14-68 id=__codelineno-14-68 name=__codelineno-14-68></a><span class=w>        </span><span class=p>}</span>
<a href=#__codelineno-14-69 id=__codelineno-14-69 name=__codelineno-14-69></a><span class=w>      </span><span class=p>},</span>
<a href=#__codelineno-14-70 id=__codelineno-14-70 name=__codelineno-14-70></a><span class=w>    </span><span class=c1>// snip</span>
<a href=#__codelineno-14-71 id=__codelineno-14-71 name=__codelineno-14-71></a><span class=w>    </span><span class=p>]</span>
<a href=#__codelineno-14-72 id=__codelineno-14-72 name=__codelineno-14-72></a><span class=w>  </span><span class=p>}</span>
<a href=#__codelineno-14-73 id=__codelineno-14-73 name=__codelineno-14-73></a><span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Listing logs emitted by <code>aaa</code> subsystem of SR Linux from <code>leaf1</code> node. <div class="language-json highlight"><pre><span></span><code><a href=#__codelineno-15-1 id=__codelineno-15-1 name=__codelineno-15-1></a><span class=err>curl</span><span class=w> </span><span class=mi>-</span><span class=err>s</span><span class=w> </span><span class=s2>"http://localhost:9200/fabric-logs-*/_search"</span><span class=w> </span><span class=mi>-</span><span class=err>H</span><span class=w> </span><span class=err>'Co</span><span class=kc>ntent</span><span class=mi>-</span><span class=err>Type</span><span class=p>:</span><span class=w> </span><span class=err>applica</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=err>/jso</span><span class=kc>n</span><span class=err>'</span><span class=w> </span><span class=mi>-</span><span class=err>d'</span>
<a href=#__codelineno-15-2 id=__codelineno-15-2 name=__codelineno-15-2></a><span class=p>{</span>
<a href=#__codelineno-15-3 id=__codelineno-15-3 name=__codelineno-15-3></a><span class=w>  </span><span class=nt>"query"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-4 id=__codelineno-15-4 name=__codelineno-15-4></a><span class=w>    </span><span class=nt>"bool"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-5 id=__codelineno-15-5 name=__codelineno-15-5></a><span class=w>      </span><span class=nt>"must"</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a href=#__codelineno-15-6 id=__codelineno-15-6 name=__codelineno-15-6></a><span class=w>        </span><span class=p>{</span>
<a href=#__codelineno-15-7 id=__codelineno-15-7 name=__codelineno-15-7></a><span class=w>          </span><span class=nt>"match"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-8 id=__codelineno-15-8 name=__codelineno-15-8></a><span class=w>            </span><span class=nt>"srl.syslog.subsystem"</span><span class=p>:</span><span class=w> </span><span class=s2>"aaa"</span>
<a href=#__codelineno-15-9 id=__codelineno-15-9 name=__codelineno-15-9></a><span class=w>          </span><span class=p>}</span>
<a href=#__codelineno-15-10 id=__codelineno-15-10 name=__codelineno-15-10></a><span class=w>        </span><span class=p>},</span>
<a href=#__codelineno-15-11 id=__codelineno-15-11 name=__codelineno-15-11></a><span class=w>        </span><span class=p>{</span>
<a href=#__codelineno-15-12 id=__codelineno-15-12 name=__codelineno-15-12></a><span class=w>          </span><span class=nt>"match"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-13 id=__codelineno-15-13 name=__codelineno-15-13></a><span class=w>            </span><span class=nt>"host.hostname"</span><span class=p>:</span><span class=w> </span><span class=s2>"leaf1"</span>
<a href=#__codelineno-15-14 id=__codelineno-15-14 name=__codelineno-15-14></a><span class=w>          </span><span class=p>}</span>
<a href=#__codelineno-15-15 id=__codelineno-15-15 name=__codelineno-15-15></a><span class=w>        </span><span class=p>}</span>
<a href=#__codelineno-15-16 id=__codelineno-15-16 name=__codelineno-15-16></a><span class=w>      </span><span class=p>]</span>
<a href=#__codelineno-15-17 id=__codelineno-15-17 name=__codelineno-15-17></a><span class=w>    </span><span class=p>}</span>
<a href=#__codelineno-15-18 id=__codelineno-15-18 name=__codelineno-15-18></a><span class=w>  </span><span class=p>}</span>
<a href=#__codelineno-15-19 id=__codelineno-15-19 name=__codelineno-15-19></a><span class=p>}</span><span class=err>'</span><span class=w> </span><span class=err>|</span><span class=w> </span><span class=err>jq</span>
<a href=#__codelineno-15-20 id=__codelineno-15-20 name=__codelineno-15-20></a><span class=p>{</span>
<a href=#__codelineno-15-21 id=__codelineno-15-21 name=__codelineno-15-21></a><span class=w>  </span><span class=nt>"took"</span><span class=p>:</span><span class=w> </span><span class=mi>35</span><span class=p>,</span>
<a href=#__codelineno-15-22 id=__codelineno-15-22 name=__codelineno-15-22></a><span class=w>  </span><span class=nt>"timed_out"</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<a href=#__codelineno-15-23 id=__codelineno-15-23 name=__codelineno-15-23></a><span class=w>  </span><span class=nt>"_shards"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-24 id=__codelineno-15-24 name=__codelineno-15-24></a><span class=w>    </span><span class=nt>"total"</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<a href=#__codelineno-15-25 id=__codelineno-15-25 name=__codelineno-15-25></a><span class=w>    </span><span class=nt>"successful"</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<a href=#__codelineno-15-26 id=__codelineno-15-26 name=__codelineno-15-26></a><span class=w>    </span><span class=nt>"skipped"</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<a href=#__codelineno-15-27 id=__codelineno-15-27 name=__codelineno-15-27></a><span class=w>    </span><span class=nt>"failed"</span><span class=p>:</span><span class=w> </span><span class=mi>0</span>
<a href=#__codelineno-15-28 id=__codelineno-15-28 name=__codelineno-15-28></a><span class=w>  </span><span class=p>},</span>
<a href=#__codelineno-15-29 id=__codelineno-15-29 name=__codelineno-15-29></a><span class=w>  </span><span class=nt>"hits"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-30 id=__codelineno-15-30 name=__codelineno-15-30></a><span class=w>    </span><span class=nt>"total"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-31 id=__codelineno-15-31 name=__codelineno-15-31></a><span class=w>      </span><span class=nt>"value"</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=p>,</span>
<a href=#__codelineno-15-32 id=__codelineno-15-32 name=__codelineno-15-32></a><span class=w>      </span><span class=nt>"relation"</span><span class=p>:</span><span class=w> </span><span class=s2>"eq"</span>
<a href=#__codelineno-15-33 id=__codelineno-15-33 name=__codelineno-15-33></a><span class=w>    </span><span class=p>},</span>
<a href=#__codelineno-15-34 id=__codelineno-15-34 name=__codelineno-15-34></a><span class=w>    </span><span class=nt>"max_score"</span><span class=p>:</span><span class=w> </span><span class=mf>3.7342224</span><span class=p>,</span>
<a href=#__codelineno-15-35 id=__codelineno-15-35 name=__codelineno-15-35></a><span class=w>    </span><span class=nt>"hits"</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a href=#__codelineno-15-36 id=__codelineno-15-36 name=__codelineno-15-36></a><span class=w>      </span><span class=p>{</span>
<a href=#__codelineno-15-37 id=__codelineno-15-37 name=__codelineno-15-37></a><span class=w>        </span><span class=nt>"_index"</span><span class=p>:</span><span class=w> </span><span class=s2>"fabric-logs-2023.02.12"</span><span class=p>,</span>
<a href=#__codelineno-15-38 id=__codelineno-15-38 name=__codelineno-15-38></a><span class=w>        </span><span class=nt>"_type"</span><span class=p>:</span><span class=w> </span><span class=s2>"_doc"</span><span class=p>,</span>
<a href=#__codelineno-15-39 id=__codelineno-15-39 name=__codelineno-15-39></a><span class=w>        </span><span class=nt>"_id"</span><span class=p>:</span><span class=w> </span><span class=s2>"-AQDRoYB-MNGUHTecRIg"</span><span class=p>,</span>
<a href=#__codelineno-15-40 id=__codelineno-15-40 name=__codelineno-15-40></a><span class=w>        </span><span class=nt>"_score"</span><span class=p>:</span><span class=w> </span><span class=mf>3.7342224</span><span class=p>,</span>
<a href=#__codelineno-15-41 id=__codelineno-15-41 name=__codelineno-15-41></a><span class=w>        </span><span class=nt>"_source"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-42 id=__codelineno-15-42 name=__codelineno-15-42></a><span class=w>          </span><span class=nt>"host"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-43 id=__codelineno-15-43 name=__codelineno-15-43></a><span class=w>            </span><span class=nt>"ip"</span><span class=p>:</span><span class=w> </span><span class=s2>"172.22.22.21"</span><span class=p>,</span>
<a href=#__codelineno-15-44 id=__codelineno-15-44 name=__codelineno-15-44></a><span class=w>            </span><span class=nt>"hostname"</span><span class=p>:</span><span class=w> </span><span class=s2>"leaf1"</span>
<a href=#__codelineno-15-45 id=__codelineno-15-45 name=__codelineno-15-45></a><span class=w>          </span><span class=p>},</span>
<a href=#__codelineno-15-46 id=__codelineno-15-46 name=__codelineno-15-46></a><span class=w>          </span><span class=nt>"ecs"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-47 id=__codelineno-15-47 name=__codelineno-15-47></a><span class=w>            </span><span class=nt>"version"</span><span class=p>:</span><span class=w> </span><span class=s2>"1.12.2"</span>
<a href=#__codelineno-15-48 id=__codelineno-15-48 name=__codelineno-15-48></a><span class=w>          </span><span class=p>},</span>
<a href=#__codelineno-15-49 id=__codelineno-15-49 name=__codelineno-15-49></a><span class=w>          </span><span class=nt>"@timestamp"</span><span class=p>:</span><span class=w> </span><span class=s2>"2023-02-12T14:24:36.000Z"</span><span class=p>,</span>
<a href=#__codelineno-15-50 id=__codelineno-15-50 name=__codelineno-15-50></a><span class=w>          </span><span class=nt>"process"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-51 id=__codelineno-15-51 name=__codelineno-15-51></a><span class=w>            </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"sr_aaa_mgr"</span>
<a href=#__codelineno-15-52 id=__codelineno-15-52 name=__codelineno-15-52></a><span class=w>          </span><span class=p>},</span>
<a href=#__codelineno-15-53 id=__codelineno-15-53 name=__codelineno-15-53></a><span class=w>          </span><span class=nt>"message"</span><span class=p>:</span><span class=w> </span><span class=s2>"Closed session for user admin from host 172.22.22.1"</span><span class=p>,</span>
<a href=#__codelineno-15-54 id=__codelineno-15-54 name=__codelineno-15-54></a><span class=w>          </span><span class=nt>"tags"</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a href=#__codelineno-15-55 id=__codelineno-15-55 name=__codelineno-15-55></a><span class=w>            </span><span class=s2>"syslog"</span><span class=p>,</span>
<a href=#__codelineno-15-56 id=__codelineno-15-56 name=__codelineno-15-56></a><span class=w>            </span><span class=s2>"srlinux"</span>
<a href=#__codelineno-15-57 id=__codelineno-15-57 name=__codelineno-15-57></a><span class=w>          </span><span class=p>],</span>
<a href=#__codelineno-15-58 id=__codelineno-15-58 name=__codelineno-15-58></a><span class=w>          </span><span class=nt>"srl"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-59 id=__codelineno-15-59 name=__codelineno-15-59></a><span class=w>            </span><span class=nt>"syslog"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-60 id=__codelineno-15-60 name=__codelineno-15-60></a><span class=w>              </span><span class=nt>"initial"</span><span class=p>:</span><span class=w> </span><span class=s2>"N"</span><span class=p>,</span>
<a href=#__codelineno-15-61 id=__codelineno-15-61 name=__codelineno-15-61></a><span class=w>              </span><span class=nt>"subsystem"</span><span class=p>:</span><span class=w> </span><span class=s2>"aaa"</span><span class=p>,</span>
<a href=#__codelineno-15-62 id=__codelineno-15-62 name=__codelineno-15-62></a><span class=w>              </span><span class=nt>"pid"</span><span class=p>:</span><span class=w> </span><span class=s2>"1227"</span><span class=p>,</span>
<a href=#__codelineno-15-63 id=__codelineno-15-63 name=__codelineno-15-63></a><span class=w>              </span><span class=nt>"thread"</span><span class=p>:</span><span class=w> </span><span class=s2>"1260"</span><span class=p>,</span>
<a href=#__codelineno-15-64 id=__codelineno-15-64 name=__codelineno-15-64></a><span class=w>              </span><span class=nt>"sequence"</span><span class=p>:</span><span class=w> </span><span class=s2>"00011"</span>
<a href=#__codelineno-15-65 id=__codelineno-15-65 name=__codelineno-15-65></a><span class=w>            </span><span class=p>}</span>
<a href=#__codelineno-15-66 id=__codelineno-15-66 name=__codelineno-15-66></a><span class=w>          </span><span class=p>},</span>
<a href=#__codelineno-15-67 id=__codelineno-15-67 name=__codelineno-15-67></a><span class=w>          </span><span class=nt>"log"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-68 id=__codelineno-15-68 name=__codelineno-15-68></a><span class=w>            </span><span class=nt>"syslog"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-69 id=__codelineno-15-69 name=__codelineno-15-69></a><span class=w>              </span><span class=nt>"severity"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-70 id=__codelineno-15-70 name=__codelineno-15-70></a><span class=w>                </span><span class=nt>"code"</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=p>,</span>
<a href=#__codelineno-15-71 id=__codelineno-15-71 name=__codelineno-15-71></a><span class=w>                </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"Notice"</span>
<a href=#__codelineno-15-72 id=__codelineno-15-72 name=__codelineno-15-72></a><span class=w>              </span><span class=p>},</span>
<a href=#__codelineno-15-73 id=__codelineno-15-73 name=__codelineno-15-73></a><span class=w>              </span><span class=nt>"facility"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a href=#__codelineno-15-74 id=__codelineno-15-74 name=__codelineno-15-74></a><span class=w>                </span><span class=nt>"code"</span><span class=p>:</span><span class=w> </span><span class=mi>22</span><span class=p>,</span>
<a href=#__codelineno-15-75 id=__codelineno-15-75 name=__codelineno-15-75></a><span class=w>                </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"local6"</span>
<a href=#__codelineno-15-76 id=__codelineno-15-76 name=__codelineno-15-76></a><span class=w>              </span><span class=p>},</span>
<a href=#__codelineno-15-77 id=__codelineno-15-77 name=__codelineno-15-77></a><span class=w>              </span><span class=nt>"priority"</span><span class=p>:</span><span class=w> </span><span class=mi>181</span>
<a href=#__codelineno-15-78 id=__codelineno-15-78 name=__codelineno-15-78></a><span class=w>            </span><span class=p>}</span>
<a href=#__codelineno-15-79 id=__codelineno-15-79 name=__codelineno-15-79></a><span class=w>          </span><span class=p>}</span>
<a href=#__codelineno-15-80 id=__codelineno-15-80 name=__codelineno-15-80></a><span class=w>        </span><span class=p>}</span>
<a href=#__codelineno-15-81 id=__codelineno-15-81 name=__codelineno-15-81></a><span class=w>      </span><span class=p>},</span>
<a href=#__codelineno-15-82 id=__codelineno-15-82 name=__codelineno-15-82></a><span class=w>      </span><span class=c1>// snipped</span>
<a href=#__codelineno-15-83 id=__codelineno-15-83 name=__codelineno-15-83></a><span class=w>    </span><span class=p>]</span>
<a href=#__codelineno-15-84 id=__codelineno-15-84 name=__codelineno-15-84></a><span class=w>  </span><span class=p>}</span>
<a href=#__codelineno-15-85 id=__codelineno-15-85 name=__codelineno-15-85></a><span class=p>}</span>
</code></pre></div></p> </div> </div> </div> </details> <h2 id=kibana>Kibana<a class=headerlink href=#kibana title="Permanent link">#</a></h2> <p><small> <a href=https://www.elastic.co/guide/en/kibana/7.17/index.html><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M0 3.75A.75.75 0 0 1 .75 3h7.497c1.566 0 2.945.8 3.751 2.014A4.496 4.496 0 0 1 15.75 3h7.5a.75.75 0 0 1 .75.75v15.063a.75.75 0 0 1-.755.75l-7.682-.052a3 3 0 0 0-2.142.878l-.89.891a.75.75 0 0 1-1.061 0l-.902-.901a3 3 0 0 0-2.121-.879H.75a.75.75 0 0 1-.75-.75v-15zm11.247 3.747a3 3 0 0 0-3-2.997H1.5V18h6.947a4.5 4.5 0 0 1 2.803.98l-.003-11.483zm1.503 11.485V7.5a3 3 0 0 1 3-3h6.75v13.558l-6.927-.047a4.5 4.5 0 0 0-2.823.971z" fill-rule=evenodd></path></svg></span> Kibana docs</a></small></p> <p>Even though Elastic is the core of the stack, we made a very short stop at it, because we will leverage Elastic powers through a UI offered by Kibana.</p> <p>Kibana enables you to give shape to your data and navigate the Elastic Stack. With Kibana, you can:</p> <ul> <li><strong>Search, observe, and protect your data.</strong> From discovering documents to analyzing logs to finding security vulnerabilities, Kibana is your portal for accessing these capabilities and more.</li> <li><strong>Analyze your data.</strong> Search for hidden insights, visualize what you’ve found in charts, gauges, maps, graphs, and more, and combine them in a dashboard.</li> <li><strong>Manage, monitor, and secure the Elastic Stack.</strong> Manage your data, monitor the health of your Elastic Stack cluster, and control which users have access to which features.</li> </ul> <p>In the context of this post, we will use the stack management, searching, and visualization capabilities of Kibana.</p> <p>To access Kibana web UI point your browser to <a href=http://localhost:5601/ >http://localhost:5601/</a> address.</p> <h3 id=index-management>Index Management<a class=headerlink href=#index-management title="Permanent link">#</a></h3> <p>Kibana makes it easy to manage your stack by providing a nice UI on top of the rich API. Using the menu, navigate to the <code>Management -&gt; Stack Management</code> item to open the management pane of the whole stack.</p> <p>To see the index created by Elastic when Logstash sends data, use the <code>Index Management</code> menu.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-width=100% href=https://gitlab.com/rdodin/pics/-/wikis/uploads/0c8de6595d322f923e390cff3de38a75/image.png><img alt=index-mgmt class=img-shadow src=https://gitlab.com/rdodin/pics/-/wikis/uploads/0c8de6595d322f923e390cff3de38a75/image.png></a></p> <p>Clicking on the index name brings up the index details, where the most interesting part is the <code>Mappings</code> used by this index.</p> <h3 id=index-patterns>Index Patterns<a class=headerlink href=#index-patterns title="Permanent link">#</a></h3> <p>Kibana requires an <a href=https://www.elastic.co/guide/en/kibana/7.17/index-patterns.html>Index Pattern</a> to access the Elasticsearch data that you want to explore. An index pattern selects the data to use and allows you to define properties of the fields.</p> <p>Select <code>Index Pattern</code> item in the Management section to create an index pattern for the index Elastic created. Apart from the pattern name that should match the index, you have to select a field that denotes the event timestamp, in our case it is <code>@timestamp</code>.</p> <p>When Index Pattern is created, you may start searching through logs and create visualizations.</p> <div class="admonition tip"> <p class=admonition-title>Load saved objects</p> <p>It might be useful to create a search and visualization panels yourself to get a hold of the process, but if you'd rather skip this part we offer an import procedure:</p> <div class="language-bash highlight"><pre><span></span><code><a href=#__codelineno-16-1 id=__codelineno-16-1 name=__codelineno-16-1></a>bash<span class=w> </span>./add-saved-objects.sh
</code></pre></div> <p>This script will load the Index Pattern, as well as a sample visualization dashboard and a Discover panel.</p> </div> <h3 id=discover>Discover<a class=headerlink href=#discover title="Permanent link">#</a></h3> <p>Now to the meat of it. The parsed logs are now neatly stored in Elastic, and you can explore them by navigating to the <code>Analytics -&gt; Discover</code> menu item. If you have imported the saved objects prepared by us, you will be able to open the <code>[Discover] Fabric Logs</code> saved search configuration that already selects some fields and sort them in descending order.</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>Selecting the saved search</label><label for=__tabbed_3_2>Selecting time window</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><a class=glightbox data-desc-position=bottom data-height=auto data-width=100% href=https://gitlab.com/rdodin/pics/-/wikis/uploads/c1cb87876330a14beb84b283b06aa89f/image.png><img alt=saved-search class=img-shadow src=https://gitlab.com/rdodin/pics/-/wikis/uploads/c1cb87876330a14beb84b283b06aa89f/image.png></a></p> </div> <div class=tabbed-block> <p>Make sure to select the time window that suits the time at which logs were collected. <a class=glightbox data-desc-position=bottom data-height=auto data-width=100% href=https://gitlab.com/rdodin/pics/-/wikis/uploads/4e07fc5550965a83600c24737b448259/image.png><img alt=time-window class=img-shadow src=https://gitlab.com/rdodin/pics/-/wikis/uploads/4e07fc5550965a83600c24737b448259/image.png></a></p> </div> </div> </div> <p>The Discover pane allows you to filter and search the documents stored in the index; you may play with the data using the query language and identify and correlate log events.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-width=100% href=https://gitlab.com/rdodin/pics/-/wikis/uploads/67058de5f0b65f8bcc66ea4714ce7189/image.png><img alt=discover class=img-shadow src=https://gitlab.com/rdodin/pics/-/wikis/uploads/67058de5f0b65f8bcc66ea4714ce7189/image.png></a></p> <h3 id=dashboard>Dashboard<a class=headerlink href=#dashboard title="Permanent link">#</a></h3> <p>In the <code>Analytics -&gt; Dashboard</code> users get a chance to create interactive dashboards with a wide variety of plots available. We provided a sample dashboard that gives you a sense of what can be displayed using the collected data.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-width=100% href=https://gitlab.com/rdodin/pics/-/wikis/uploads/497301caef8c5915f1d8d1126dbf288e/image.png><img alt=dash class=img-shadow src=https://gitlab.com/rdodin/pics/-/wikis/uploads/497301caef8c5915f1d8d1126dbf288e/image.png></a></p> <p>The provided dashboard also makes it easy to skim through logs and select the ones you need to dive into:</p> <video controls width=100%><source src=https://gitlab.com/rdodin/pics/-/wikis/uploads/bfa97831e557a5d0ab6f4245497d9e81/2023-02-11_18-23-48.mp4 type=video/mp4></video> <h2 id=summary>Summary<a class=headerlink href=#summary title="Permanent link">#</a></h2> <p>Congratulations, you've reached the end of this post <img alt=👏 class=twemoji src=https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f44f.svg title=:clap:> <img alt=👏 class=twemoji src=https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f44f.svg title=:clap:> <img alt=👏 class=twemoji src=https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f44f.svg title=:clap:></p> <p>We hope you liked it and learned how logs from the network elements could be fed into the modern logging infrastructure based on ELK stack.</p> <p>It all started with <a href=#configuring-logging-on-sr-linux>configuring</a> Syslog on SR Linux.</p> <p>Unfortunately, the unstructured nature of RFC3164 Syslog mandated the use of <a href=#logstash>Logstash</a>, which is a feature-rich log collector. We learned how to use Logstash to parse the unstructured logs, transform them into JSON documents, and output them to Elasticsearh for storage.</p> <p>With <a href=#filter>Index Templates</a> we learned how to provide the type information for our Elastic index making sure the parsed fields use the correct type, which is crucial for an effective discovery process.</p> <p>Finally, using <a href=#kibana>Kibana</a> we learned how to perform basic Stack Management and used search and navigation capabilities.</p> <p>We left A LOT behind the brackets of this post. API access, logs correlation, Logstash-less collection using elastic-agent, k8s-based deployments. Maybe we should cover some of this in the subsequent post. Let us know in the comments, and till the next one <img alt=👋 class=twemoji src=https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f44b.svg title=:wave:></p> <script async src=https://viewer.diagrams.net/js/viewer-static.min.js type=text/javascript></script> <div class=footnote> <hr> <ol> <li id=fn:1> <p>The lab was tested with these particular versions. It might work with a more recent version of the components. <a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">↩</a></p> </li> <li id=fn:2> <p>The SR Linux installs a minimal version of the <code>/etc/rsyslog.conf</code> file and maintains an SR Linux-specific configuration file in the <code>/etc/rsyslog.d/</code> directory. <a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text">↩</a></p> </li> <li id=fn:3> <p>For fine-grain control over the log messages, refer to the <a href=https://documentation.nokia.com/srlinux/22-6/SR_Linux_Book_Files/Configuration_Basics_Guide/configb-logging.html#define_filters>Filter</a> section of the logging guide. <a class=footnote-backref href=#fnref:3 title="Jump back to footnote 3 in the text">↩</a></p> </li> <li id=fn:4> <p>The informational RFC 3164 for Syslog was obsoleted by <a href=https://datatracker.ietf.org/doc/html/rfc5424>RFC 5424</a>, but unfortunately, it didn't get traction in the industry. <a class=footnote-backref href=#fnref:4 title="Jump back to footnote 4 in the text">↩</a></p> </li> <li id=fn:5> <p>Check the <a href=#output>output</a> section to see how ECS populates data in the <code>log</code>, <code>host</code> and <code>process</code> objects automatically when parsing the syslog messages. <a class=footnote-backref href=#fnref:5 title="Jump back to footnote 5 in the text">↩</a></p> </li> </ol> </div> <h2 id=__comments>Comments</h2> <script async crossorigin=anonymous data-category=comments data-category-id=DIC_kwDOFtXuas4CR_vG data-emit-metadata=0 data-input-position=top data-lang=en data-loading=lazy data-mapping=pathname data-reactions-enabled=1 data-repo=srl-labs/learn-srlinux data-repo-id="MDEwOlJlcG9zaXRvcnkzODMxMTg5NTQ=" data-strict=0 data-theme=preferred_color_scheme src=https://giscus.app/client.js>
</script> <!-- Synchronize Giscus theme with palette --> <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate" ? "dark" : "light"
        giscus.setAttribute("data-theme", theme)
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function () {
        var ref = document.querySelector("[data-md-component=palette]")
        ref.addEventListener("change", function () {
            var palette = __md_get("__palette")
            if (palette && typeof palette.color === "object") {
                var theme = palette.color.scheme === "slate" ? "dark" : "light"

                /* Instruct Giscus to change theme */
                var frame = document.querySelector(".giscus-frame")
                frame.contentWindow.postMessage(
                    { giscus: { setConfig: { theme } } },
                    "https://giscus.app"
                )
            }
        })
    })
</script> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <a class="md-top md-icon" data-md-component=top hidden href=#> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <!--
  Copyright (c) 2016-2022 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Copyright and theme information --> <div class=md-copyright> <div class=md-copyright__highlight> Copyright © 2021-2023 Nokia </div> Made with <span class="twemoji mdx-heart"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> by <a href=https://github.com/srl-labs rel=noopener target=_blank> SR Linux team </a> </div> <div class=md-social> <a class=md-social__link href=https://discord.gg/tZvgjQ6PZf rel=noopener target=_blank title=discord.gg> <svg viewbox="0 0 640 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"></path></svg> </a> <a class=md-social__link href=https://github.com/srl-labs rel=noopener target=_blank title=github.com> <svg viewbox="0 0 496 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </a> <a class=md-social__link href=https://twitter.com/ntdvps rel=noopener target=_blank title=twitter.com> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.top", "navigation.instant", "navigation.tabs", "search.suggest", "content.code.annotate", "content.code.copy", "content.action.edit", "toc.follow", "content.tooltips", "navigation.indexes", "announce.dismiss"], "search": "../../../assets/javascripts/workers/search.f236eb64.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.abfe3e55.min.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>